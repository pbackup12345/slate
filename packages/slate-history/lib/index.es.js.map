{"version":3,"file":"index.es.js","sources":["../../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../../node_modules/@babel/runtime/helpers/createClass.js","../../../node_modules/@babel/runtime/helpers/typeof.js","../../../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../../../node_modules/@babel/runtime/helpers/superPropBase.js","../../../node_modules/@babel/runtime/helpers/get.js","../../../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../../../node_modules/@babel/runtime/helpers/inherits.js","../src/plugin.ts","../src/history.ts"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","import { produce } from 'immer'\r\nimport { Editor, Operation, Path } from 'slate'\r\nimport { History } from './history'\r\n\r\nconst HISTORY = Symbol('history')\r\nconst SAVING = Symbol('saving')\r\nconst MERGING = Symbol('merging')\r\n\r\n/**\r\n * `HistoryEditor` is a Slate editor class with `withHistory` mixed in.\r\n */\r\n\r\nexport type HistoryEditor = InstanceType<ReturnType<typeof withHistory>>\r\n\r\n/**\r\n * The `withHistory` mixin keeps track of the operation history of a Slate\r\n * editor as operations are applied to it, using undo and redo stacks.\r\n */\r\n\r\nexport const withHistory = (Editor: new (...args: any[]) => Editor) => {\r\n  return class HistoryEditor extends Editor {\r\n    [HISTORY]: History;\r\n    [MERGING]: boolean | null;\r\n    [SAVING]: boolean\r\n\r\n    /**\r\n     * Setup defaults for weak maps on construct.\r\n     */\r\n\r\n    constructor(...args: any[]) {\r\n      super(...args)\r\n      const history: History = produce({ undos: [], redos: [] }, () => {})\r\n      this[HISTORY] = history\r\n      this[MERGING] = null\r\n      this[SAVING] = true\r\n    }\r\n\r\n    /**\r\n     * When an operation is applied to the editor, save it.\r\n     */\r\n\r\n    apply(op: Operation): void {\r\n      const { operations } = this\r\n      const history = this[HISTORY]\r\n      let save = this[SAVING]\r\n      let merge = this[MERGING]\r\n\r\n      this[HISTORY] = produce(history, h => {\r\n        const { undos } = h\r\n        const lastBatch = undos[undos.length - 1]\r\n        const lastOp = lastBatch && lastBatch[lastBatch.length - 1]\r\n        const overwrite = shouldOverwrite(op, lastOp)\r\n\r\n        if (save == null) {\r\n          save = shouldSave(op, lastOp)\r\n        }\r\n\r\n        if (!save) {\r\n          return\r\n        }\r\n\r\n        if (merge == null) {\r\n          if (lastBatch == null) {\r\n            merge = false\r\n          } else if (operations.length !== 0) {\r\n            merge = true\r\n          } else {\r\n            merge = shouldMerge(op, lastOp) || overwrite\r\n          }\r\n        }\r\n\r\n        if (lastBatch && merge) {\r\n          if (overwrite) {\r\n            lastBatch.pop()\r\n          }\r\n\r\n          lastBatch.push(op)\r\n        } else {\r\n          const batch = [op]\r\n          undos.push(batch)\r\n        }\r\n\r\n        while (undos.length > 100) {\r\n          undos.shift()\r\n        }\r\n\r\n        h.redos = []\r\n      })\r\n\r\n      super.apply(op)\r\n    }\r\n\r\n    /**\r\n     * Get the history object for the editor.\r\n     */\r\n\r\n    getHistory(): History {\r\n      return this[HISTORY]\r\n    }\r\n\r\n    /**\r\n     * Redo the last batch of operations in the history.\r\n     */\r\n\r\n    redo(): void {\r\n      const history = this[HISTORY]\r\n      const { redos } = history\r\n\r\n      if (redos.length === 0) {\r\n        return\r\n      }\r\n\r\n      const batch = redos[redos.length - 1]\r\n\r\n      this.withoutSaving(() => {\r\n        this.withoutNormalizing(() => {\r\n          for (const op of batch) {\r\n            this.apply(op)\r\n          }\r\n        })\r\n      })\r\n\r\n      this[HISTORY] = produce(history, h => {\r\n        h.redos.pop()\r\n        h.undos.push(batch)\r\n      })\r\n    }\r\n\r\n    /**\r\n     * Undo the last batch of operations in the history.\r\n     */\r\n\r\n    undo(): void {\r\n      const history = this[HISTORY]\r\n      const { undos } = history\r\n\r\n      if (undos.length === 0) {\r\n        return\r\n      }\r\n\r\n      const batch = undos[undos.length - 1]\r\n\r\n      this.withoutSaving(() => {\r\n        this.withoutNormalizing(() => {\r\n          const inverseOps = batch.map(Operation.inverse).reverse()\r\n\r\n          for (const op of inverseOps) {\r\n            // If the final operation is deselecting the editor, skip it. This is\r\n            if (\r\n              op === inverseOps[inverseOps.length - 1] &&\r\n              op.type === 'set_selection' &&\r\n              op.newProperties == null\r\n            ) {\r\n              continue\r\n            } else {\r\n              this.apply(op)\r\n            }\r\n          }\r\n        })\r\n      })\r\n\r\n      this[HISTORY] = produce(history, h => {\r\n        h.redos.push(batch)\r\n        h.undos.pop()\r\n      })\r\n    }\r\n\r\n    /**\r\n     * Apply a series of changes inside a synchronous `fn`, without merging any of\r\n     * the new operations into previous save point in the history.\r\n     */\r\n\r\n    withoutMerging(fn: () => void): void {\r\n      const prev = this[MERGING]\r\n      this[MERGING] = false\r\n      fn()\r\n      this[MERGING] = prev\r\n    }\r\n\r\n    /**\r\n     * Apply a series of changes inside a synchronous `fn`, without saving any of\r\n     * their operations into the history.\r\n     */\r\n\r\n    withoutSaving(fn: () => void): void {\r\n      const prev = this[SAVING]\r\n      this[SAVING] = false\r\n      fn()\r\n      this[SAVING] = prev\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Check whether to merge an operation into the previous operation.\r\n */\r\n\r\nconst shouldMerge = (op: Operation, prev: Operation | undefined): boolean => {\r\n  if (op.type === 'set_selection') {\r\n    return true\r\n  }\r\n\r\n  if (\r\n    prev &&\r\n    op.type === 'insert_text' &&\r\n    prev.type === 'insert_text' &&\r\n    op.offset === prev.offset + prev.text.length &&\r\n    Path.equals(op.path, prev.path)\r\n  ) {\r\n    return true\r\n  }\r\n\r\n  if (\r\n    prev &&\r\n    op.type === 'remove_text' &&\r\n    prev.type === 'remove_text' &&\r\n    op.offset + op.text.length === prev.offset &&\r\n    Path.equals(op.path, prev.path)\r\n  ) {\r\n    return true\r\n  }\r\n\r\n  return false\r\n}\r\n\r\n/**\r\n * Check whether an operation needs to be saved to the history.\r\n */\r\n\r\nconst shouldSave = (op: Operation, prev: Operation | undefined): boolean => {\r\n  if (op.type === 'set_selection' && op.newProperties == null) {\r\n    return false\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * Check whether an operation should overwrite the previous one.\r\n */\r\n\r\nconst shouldOverwrite = (\r\n  op: Operation,\r\n  prev: Operation | undefined\r\n): boolean => {\r\n  if (prev && op.type === 'set_selection' && prev.type === 'set_selection') {\r\n    return true\r\n  }\r\n\r\n  return false\r\n}\r\n","import isPlainObject from 'is-plain-object'\r\nimport { Operation } from 'slate'\r\n\r\n/**\r\n * `History` objects hold all of the operations that are applied to a value, so\r\n * they can be undone or redone as necessary.\r\n */\r\n\r\ninterface History {\r\n  redos: Operation[][]\r\n  undos: Operation[][]\r\n}\r\n\r\nnamespace History {\r\n  /**\r\n   * Check if a value is a `History` object.\r\n   */\r\n\r\n  export const isHistory = (value: any): value is History => {\r\n    return (\r\n      isPlainObject(value) &&\r\n      Array.isArray(value.redos) &&\r\n      Array.isArray(value.undos) &&\r\n      (value.redos.length === 0 || Operation.isOperationList(value.redos[0])) &&\r\n      (value.undos.length === 0 || Operation.isOperationList(value.undos[0]))\r\n    )\r\n  }\r\n}\r\n\r\nexport { History }\r\n"],"names":["_typeof","HISTORY","Symbol","SAVING","MERGING","withHistory","Editor","args","history","produce","undos","redos","op","operations","save","merge","h","lastBatch","length","lastOp","overwrite","shouldOverwrite","shouldSave","shouldMerge","pop","push","batch","shift","withoutSaving","withoutNormalizing","apply","inverseOps","map","Operation","inverse","reverse","type","newProperties","fn","prev","offset","text","Path","equals","path","History","value","isPlainObject","Array","isArray","isOperationList"],"mappings":"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"}
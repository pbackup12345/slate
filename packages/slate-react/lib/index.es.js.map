{"version":3,"file":"index.es.js","sources":["../src/hooks/use-editor.ts","../src/components/string.tsx","../src/components/custom.tsx","../src/utils/weak-maps.ts","../../../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../../../node_modules/@babel/runtime/helpers/iterableToArray.js","../../../node_modules/@babel/runtime/helpers/nonIterableSpread.js","../../../node_modules/@babel/runtime/helpers/toConsumableArray.js","../../../node_modules/@babel/runtime/helpers/defineProperty.js","../src/utils/leaf.ts","../src/components/leaf.tsx","../src/components/text.tsx","../src/hooks/use-read-only.ts","../src/hooks/use-selected.ts","../src/components/element.tsx","../src/components/children.tsx","../src/hooks/use-focused.ts","../src/utils/environment.ts","../../../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../../../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../../../node_modules/@babel/runtime/helpers/nonIterableRest.js","../../../node_modules/@babel/runtime/helpers/slicedToArray.js","../src/utils/dom.ts","../src/utils/utils.ts","../src/components/editor.tsx","../src/hooks/use-slate.ts","../../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../../node_modules/@babel/runtime/helpers/createClass.js","../../../node_modules/@babel/runtime/helpers/typeof.js","../../../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../../../node_modules/@babel/runtime/helpers/superPropBase.js","../../../node_modules/@babel/runtime/helpers/get.js","../../../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../../../node_modules/@babel/runtime/helpers/inherits.js","../src/utils/hotkeys.ts","../src/utils/key.ts","../src/plugin.ts"],"sourcesContent":["import { createContext, useContext } from 'react'\r\nimport { ReactEditor } from '..'\r\n\r\n/**\r\n * A React context for sharing the `ReactEditor` class.\r\n */\r\n\r\nexport const EditorContext = createContext<ReactEditor | undefined>(undefined)\r\n\r\n/**\r\n * Get the current `ReactEditor` class that the component lives under.\r\n */\r\n\r\nexport const useEditor = () => {\r\n  const editor = useContext(EditorContext)\r\n\r\n  if (!editor) {\r\n    throw new Error(\r\n      `The \\`useEditor\\` hook must be used inside the <Editor> context.`\r\n    )\r\n  }\r\n\r\n  return editor\r\n}\r\n","import React from 'react';\r\nimport { Element, Node, Path, Text } from 'slate';\r\n\r\nimport { useEditor } from '../hooks/use-editor';\r\nimport { Leaf } from '../utils/leaf';\r\n\r\nconst String = (props: {\r\n  isLast: boolean\r\n  leaf: Leaf\r\n  parent: Element\r\n  text: Text\r\n}) => {\r\n  const { isLast, leaf, parent, text } = props\r\n  const editor = useEditor()\r\n  const path = editor.findPath(text)\r\n  const parentPath = Path.parent(path)\r\n\r\n  // COMPAT: Render text inside void nodes with a zero-width space.\r\n  // So the node can contain selection but the text is not visible.\r\n  if (editor.isVoid(parent)) {\r\n    return <ZeroWidthString length={Node.text(parent).length} />\r\n  }\r\n\r\n  // COMPAT: If this is the last text node in an empty block, render a zero-\r\n  // width space that will convert into a line break when copying and pasting\r\n  // to support expected plain text.\r\n  if (\r\n    leaf.text === '' &&\r\n    parent.children[parent.children.length - 1] === text &&\r\n    !editor.isInline(parent) &&\r\n    editor.getText(parentPath) === ''\r\n  ) {\r\n    return <ZeroWidthString isLineBreak />\r\n  }\r\n\r\n  // COMPAT: If the text is empty, it's because it's on the edge of an inline\r\n  // node, so we render a zero-width space so that the selection can be\r\n  // inserted next to it still.\r\n  if (leaf.text === '') {\r\n    return <ZeroWidthString />\r\n  }\r\n\r\n  // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\r\n  // so we need to add an extra trailing new lines to prevent that.\r\n  if (isLast && leaf.text.slice(-1) === '\\n') {\r\n    return <TextString isTrailing text={leaf.text} />\r\n  }\r\n\r\n  return <TextString text={leaf.text} />\r\n}\r\n\r\n/**\r\n * Leaf strings with text in them.\r\n */\r\n\r\nconst TextString = (props: { text: string; isTrailing?: boolean }) => {\r\n  const { text, isTrailing = false } = props\r\n  return (\r\n    <span data-slate-string>\r\n      {text}\r\n      {isTrailing ? '\\n' : null}\r\n    </span>\r\n  )\r\n}\r\n\r\n/**\r\n * Leaf strings without text, render as zero-width strings.\r\n */\r\n\r\nconst ZeroWidthString = (props: { length?: number; isLineBreak?: boolean }) => {\r\n  const { length = 0, isLineBreak = false } = props\r\n  return (\r\n    <span\r\n      data-slate-zero-width={isLineBreak ? 'n' : 'z'}\r\n      data-slate-length={length}\r\n    >\r\n      {'\\uFEFF'}\r\n      {isLineBreak ? <br /> : null}\r\n    </span>\r\n  )\r\n}\r\n\r\nexport default String\r\n","import React from 'react'\r\nimport { Element, Range, Mark, Text } from 'slate'\r\n\r\nimport { useEditor } from '../hooks/use-editor'\r\nimport { Leaf } from '../utils/leaf'\r\n\r\n/**\r\n * `CustomAnnotationProps` are passed to the `renderAnnotation` handler.\r\n */\r\n\r\nexport interface CustomAnnotationProps {\r\n  annotation: Range\r\n  children: any\r\n  key: string\r\n  leaf: Leaf\r\n  text: Text\r\n  attributes: {\r\n    'data-slate-annotation': true\r\n  }\r\n}\r\n\r\n/**\r\n * The default custom annotation renderer.\r\n */\r\n\r\nexport const CustomAnnotation = (props: CustomAnnotationProps) => {\r\n  const { attributes, children } = props\r\n  return <span {...attributes}>{children}</span>\r\n}\r\n\r\nexport interface CustomDecorationProps {\r\n  children: any\r\n  decoration: Range\r\n  leaf: Leaf\r\n  text: Text\r\n  attributes: {\r\n    'data-slate-decoration': true\r\n  }\r\n}\r\n\r\n/**\r\n * The default custom decoration renderer.\r\n */\r\n\r\nexport const CustomDecoration = (props: CustomDecorationProps) => {\r\n  const { attributes, children } = props\r\n  return <span {...attributes}>{children}</span>\r\n}\r\n\r\n/**\r\n * `CustomElementProps` are passed to the `renderElement` handler.\r\n */\r\n\r\nexport interface CustomElementProps {\r\n  children: any\r\n  element: Element\r\n  attributes: {\r\n    'data-slate-inline'?: true\r\n    'data-slate-node': 'element'\r\n    'data-slate-void'?: true\r\n    dir?: 'rtl'\r\n    ref: any\r\n  }\r\n}\r\n\r\n/**\r\n * The default element renderer.\r\n */\r\n\r\nexport const CustomElement = (props: CustomElementProps) => {\r\n  const { attributes, children, element } = props\r\n  const editor = useEditor()\r\n  const Tag = editor.isInline(element) ? 'span' : 'div'\r\n  return (\r\n    <Tag {...attributes} style={{ position: 'relative' }}>\r\n      {children}\r\n    </Tag>\r\n  )\r\n}\r\n\r\n/**\r\n * `CustomMarkProps` are passed to the `renderMark` handler.\r\n */\r\n\r\nexport interface CustomMarkProps {\r\n  children: any\r\n  mark: Mark\r\n  leaf: Leaf\r\n  text: Text\r\n  attributes: {\r\n    'data-slate-mark': true\r\n  }\r\n}\r\n\r\n/**\r\n * The default custom mark renderer.\r\n */\r\n\r\nexport const CustomMark = (props: CustomMarkProps) => {\r\n  const { attributes, children } = props\r\n  return <span {...attributes}>{children}</span>\r\n}\r\n\r\n/**\r\n * A custom decoration for the default placeholder behavior.\r\n */\r\n\r\nexport const PlaceholderDecoration = (props: CustomDecorationProps) => {\r\n  const { decoration, attributes, children } = props\r\n  const { placeholder } = decoration\r\n  return (\r\n    <span {...attributes}>\r\n      <span\r\n        contentEditable={false}\r\n        style={{\r\n          pointerEvents: 'none',\r\n          display: 'inline-block',\r\n          verticalAlign: 'text-top',\r\n          width: '0',\r\n          maxWidth: '100%',\r\n          whiteSpace: 'nowrap',\r\n          opacity: '0.333',\r\n        }}\r\n      >\r\n        {placeholder}\r\n      </span>\r\n      {children}\r\n    </span>\r\n  )\r\n}\r\n","import { Node, Ancestor, Editor } from 'slate'\r\n\r\nimport { Key } from './key'\r\n\r\n/**\r\n * Two weak maps that allow us rebuild a path given a node. They are populated\r\n * at render time such that after a render occurs we can always backtrack.\r\n */\r\n\r\nexport const NODE_TO_INDEX: WeakMap<Node, number> = new WeakMap()\r\nexport const NODE_TO_PARENT: WeakMap<Node, Ancestor> = new WeakMap()\r\n\r\n/**\r\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\r\n * are used to resolve DOM event-related logic into Slate actions.\r\n */\r\n\r\nexport const EDITOR_TO_ELEMENT: WeakMap<Editor, HTMLElement> = new WeakMap()\r\nexport const NODE_TO_ELEMENT: WeakMap<Node, HTMLElement> = new WeakMap()\r\nexport const ELEMENT_TO_NODE: WeakMap<HTMLElement, Node> = new WeakMap()\r\nexport const NODE_TO_KEY: WeakMap<Node, Key> = new WeakMap()\r\nexport const KEY_TO_ELEMENT: WeakMap<Key, HTMLElement> = new WeakMap()\r\n\r\n/**\r\n * Weak maps for storing editor-related state.\r\n */\r\n\r\nexport const IS_READ_ONLY: WeakMap<Editor, boolean> = new WeakMap()\r\nexport const IS_FOCUSED: WeakMap<Editor, boolean> = new WeakMap()\r\nexport const IS_DRAGGING: WeakMap<Editor, boolean> = new WeakMap()\r\nexport const IS_CLICKING: WeakMap<Editor, boolean> = new WeakMap()\r\nexport const PLACEHOLDER: WeakMap<Editor, string | undefined> = new WeakMap()\r\n\r\n/**\r\n * Symbols.\r\n */\r\n\r\nexport const PLACEHOLDER_SYMBOL = Symbol('placeholder')\r\n","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","import isPlainObject from 'is-plain-object'\r\nimport { Range, Mark } from 'slate'\r\n\r\n/**\r\n * The `Leaf` interface represents the individual leaves inside a text node,\r\n * once annotations and decorations have been applied.\r\n */\r\n\r\ninterface Leaf {\r\n  annotations: Record<string, Range>\r\n  decorations: Range[]\r\n  marks: Mark[]\r\n  text: string\r\n}\r\n\r\nnamespace Leaf {\r\n  /**\r\n   * Check if two leaves are equal.\r\n   */\r\n\r\n  export const equals = (leaf: Leaf, another: Leaf): boolean => {\r\n    return (\r\n      leaf.text === another.text &&\r\n      leaf.annotations.length === another.annotations.length &&\r\n      leaf.decorations.length === another.decorations.length &&\r\n      leaf.marks.length === another.marks.length &&\r\n      leaf.marks.every(m => Mark.exists(m, another.marks)) &&\r\n      another.marks.every(m => Mark.exists(m, leaf.marks)) &&\r\n      isRangeListEqual(leaf.decorations, another.decorations) &&\r\n      isRangeMapEqual(leaf.annotations, another.annotations)\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Check if a value is a `Leaf` object.\r\n   */\r\n\r\n  export const isLeaf = (value: any): value is Leaf => {\r\n    return (\r\n      isPlainObject(value) &&\r\n      typeof value.text === 'string' &&\r\n      Mark.isMarkSet(value.marks) &&\r\n      Range.isRangeList(value.decorations) &&\r\n      Range.isRangeMap(value.annotations)\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Split a leaf into two at an offset.\r\n   */\r\n\r\n  export const split = (leaf: Leaf, offset: number): [Leaf, Leaf] => {\r\n    return [\r\n      {\r\n        text: leaf.text.slice(0, offset),\r\n        marks: leaf.marks,\r\n        annotations: { ...leaf.annotations },\r\n        decorations: [...leaf.decorations],\r\n      },\r\n      {\r\n        text: leaf.text.slice(offset),\r\n        marks: leaf.marks,\r\n        annotations: { ...leaf.annotations },\r\n        decorations: [...leaf.decorations],\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\n/**\r\n * Check if a list of ranges is equal to another.\r\n *\r\n * PERF: this requires the two lists to also have the ranges inside them in the\r\n * same order, but this is an okay constraint for us since decorations are\r\n * kept in order, and the odd case where they aren't is okay to re-render for.\r\n */\r\n\r\nconst isRangeListEqual = (list: Range[], another: Range[]): boolean => {\r\n  if (list.length !== another.length) {\r\n    return false\r\n  }\r\n\r\n  for (let i = 0; i < list.length; i++) {\r\n    const range = list[i]\r\n    const other = another[i]\r\n\r\n    if (!Range.equals(range, other)) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * Check if a map of ranges is equal to another.\r\n */\r\n\r\nconst isRangeMapEqual = (\r\n  map: Record<string, Range>,\r\n  another: Record<string, Range>\r\n): boolean => {\r\n  if (Object.keys(map).length !== Object.keys(another).length) {\r\n    return false\r\n  }\r\n\r\n  for (const key in map) {\r\n    const range = map[key]\r\n    const other = another[key]\r\n\r\n    if (!Range.equals(range, other)) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nexport { Leaf, isRangeListEqual, isRangeMapEqual }\r\n","import React from 'react'\r\nimport { Text, Element } from 'slate'\r\nimport String from './string'\r\nimport {\r\n  CustomAnnotation,\r\n  CustomAnnotationProps,\r\n  CustomDecoration,\r\n  CustomDecorationProps,\r\n  CustomMark,\r\n  CustomMarkProps,\r\n  PlaceholderDecoration,\r\n} from './custom'\r\nimport { PLACEHOLDER_SYMBOL } from '../utils/weak-maps'\r\nimport { Leaf as SlateLeaf } from '../utils/leaf'\r\n\r\n/**\r\n * Individual leaves in a text node with unique formatting.\r\n */\r\n\r\nconst Leaf = (props: {\r\n  isLast: boolean\r\n  leaf: SlateLeaf\r\n  parent: Element\r\n  renderAnnotation?: (props: CustomAnnotationProps) => JSX.Element\r\n  renderDecoration?: (props: CustomDecorationProps) => JSX.Element\r\n  renderMark?: (props: CustomMarkProps) => JSX.Element\r\n  text: Text\r\n}) => {\r\n  const {\r\n    leaf,\r\n    isLast,\r\n    text,\r\n    parent,\r\n    renderAnnotation = (props: CustomAnnotationProps) => (\r\n      <CustomAnnotation {...props} />\r\n    ),\r\n    renderDecoration = (props: CustomDecorationProps) => (\r\n      <CustomDecoration {...props} />\r\n    ),\r\n    renderMark = (props: CustomMarkProps) => <CustomMark {...props} />,\r\n  } = props\r\n\r\n  let children = (\r\n    <String isLast={isLast} leaf={leaf} parent={parent} text={text} />\r\n  )\r\n\r\n  // COMPAT: Having the `data-` attributes on these leaf elements ensures that\r\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\r\n  // contenteditable behaviors. (2019/05/08)\r\n  for (const mark of leaf.marks) {\r\n    const ret = renderMark({\r\n      children,\r\n      leaf,\r\n      mark,\r\n      text,\r\n      attributes: {\r\n        'data-slate-mark': true,\r\n      },\r\n    })\r\n\r\n    if (ret) {\r\n      children = ret\r\n    }\r\n  }\r\n\r\n  for (const decoration of leaf.decorations) {\r\n    const p = {\r\n      children,\r\n      decoration,\r\n      leaf,\r\n      text,\r\n      attributes: {\r\n        'data-slate-decoration': true,\r\n      },\r\n    }\r\n\r\n    if (PLACEHOLDER_SYMBOL in decoration) {\r\n      // @ts-ignore\r\n      children = <PlaceholderDecoration {...p} />\r\n    } else {\r\n      // @ts-ignore\r\n      const ret = renderDecoration(p)\r\n\r\n      if (ret) {\r\n        children = ret\r\n      }\r\n    }\r\n  }\r\n\r\n  for (const key in leaf.annotations) {\r\n    const annotation = leaf.annotations[key]\r\n    const ret = renderAnnotation({\r\n      annotation,\r\n      children,\r\n      key,\r\n      leaf,\r\n      text,\r\n      attributes: {\r\n        'data-slate-annotation': true,\r\n      },\r\n    })\r\n\r\n    if (ret) {\r\n      children = ret\r\n    }\r\n  }\r\n\r\n  return <span data-slate-leaf>{children}</span>\r\n}\r\n\r\nconst MemoizedLeaf = React.memo(Leaf, (prev, next) => {\r\n  return (\r\n    next.parent === prev.parent &&\r\n    next.isLast === prev.isLast &&\r\n    next.renderAnnotation === prev.renderAnnotation &&\r\n    next.renderDecoration === prev.renderDecoration &&\r\n    next.renderMark === prev.renderMark &&\r\n    next.text === prev.text &&\r\n    SlateLeaf.equals(next.leaf, prev.leaf)\r\n  )\r\n})\r\n\r\nexport default MemoizedLeaf\r\n","import React, { useLayoutEffect, useRef } from 'react'\r\nimport { Range, Element, Text as SlateText } from 'slate'\r\n\r\nimport Leaf from './leaf'\r\nimport { Leaf as SlateLeaf } from '../utils/leaf'\r\nimport { useEditor } from '../hooks/use-editor'\r\nimport {\r\n  KEY_TO_ELEMENT,\r\n  NODE_TO_ELEMENT,\r\n  ELEMENT_TO_NODE,\r\n} from '../utils/weak-maps'\r\nimport {\r\n  CustomAnnotationProps,\r\n  CustomDecorationProps,\r\n  CustomMarkProps,\r\n} from './custom'\r\n\r\n/**\r\n * Text.\r\n */\r\n\r\nconst Text = (props: {\r\n  annotations: Record<string, Range>\r\n  decorations: Range[]\r\n  isLast: boolean\r\n  parent: Element\r\n  renderAnnotation?: (props: CustomAnnotationProps) => JSX.Element\r\n  renderDecoration?: (props: CustomDecorationProps) => JSX.Element\r\n  renderMark?: (props: CustomMarkProps) => JSX.Element\r\n  text: SlateText\r\n}) => {\r\n  const {\r\n    annotations,\r\n    decorations,\r\n    isLast,\r\n    parent,\r\n    renderAnnotation,\r\n    renderDecoration,\r\n    renderMark,\r\n    text,\r\n  } = props\r\n  const editor = useEditor()\r\n  const ref = useRef<HTMLSpanElement>(null)\r\n  const leaves = getLeaves(text, annotations, decorations)\r\n  const key = editor.findKey(text)\r\n  const children = []\r\n\r\n  for (let i = 0; i < leaves.length; i++) {\r\n    const leaf = leaves[i]\r\n\r\n    children.push(\r\n      <Leaf\r\n        isLast={isLast && i === leaves.length - 1}\r\n        key={`${key.id}-${i}`}\r\n        leaf={leaf}\r\n        text={text}\r\n        parent={parent}\r\n        renderAnnotation={renderAnnotation}\r\n        renderDecoration={renderDecoration}\r\n        renderMark={renderMark}\r\n      />\r\n    )\r\n  }\r\n\r\n  // Update element-related weak maps with the DOM element ref.\r\n  useLayoutEffect(() => {\r\n    if (ref.current) {\r\n      KEY_TO_ELEMENT.set(key, ref.current)\r\n      NODE_TO_ELEMENT.set(text, ref.current)\r\n      ELEMENT_TO_NODE.set(ref.current, text)\r\n    } else {\r\n      KEY_TO_ELEMENT.delete(key)\r\n      NODE_TO_ELEMENT.delete(text)\r\n    }\r\n  })\r\n\r\n  return (\r\n    <span data-slate-node=\"text\" ref={ref}>\r\n      {children}\r\n    </span>\r\n  )\r\n}\r\n\r\n/**\r\n * Get the leaves for a text node given annotations and decorations.\r\n */\r\n\r\nconst getLeaves = (\r\n  node: SlateText,\r\n  annotations: Record<string, Range>,\r\n  decorations: Range[]\r\n): SlateLeaf[] => {\r\n  const { text, marks } = node\r\n  let leaves: SlateLeaf[] = [{ text, marks, annotations: {}, decorations: [] }]\r\n\r\n  const compile = (\r\n    collection: 'annotations' | 'decorations',\r\n    range: Range,\r\n    key?: string\r\n  ) => {\r\n    const [start, end] = Range.edges(range)\r\n    const next = []\r\n    let o = 0\r\n\r\n    for (const leaf of leaves) {\r\n      const { length } = leaf.text\r\n      const offset = o\r\n      o += length\r\n\r\n      // If the range encompases the entire leaf, add the range.\r\n      if (start.offset <= offset && end.offset >= offset + length) {\r\n        if (collection === 'annotations') {\r\n          leaf.annotations[key!] = range\r\n        } else {\r\n          leaf.decorations.push(range)\r\n        }\r\n\r\n        next.push(leaf)\r\n        continue\r\n      }\r\n\r\n      // If the range starts after the leaf, or ends before it, continue.\r\n      if (\r\n        start.offset > offset + length ||\r\n        end.offset < offset ||\r\n        (end.offset === offset && offset !== 0)\r\n      ) {\r\n        next.push(leaf)\r\n        continue\r\n      }\r\n\r\n      // Otherwise we need to split the leaf, at the start, end, or both,\r\n      // and add the range to the middle intersecting section. Do the end\r\n      // split first since we don't need to update the offset that way.\r\n      let middle = leaf\r\n      let before\r\n      let after\r\n\r\n      if (end.offset < offset + length) {\r\n        ;[middle, after] = SlateLeaf.split(middle, end.offset - offset)\r\n      }\r\n\r\n      if (start.offset > offset) {\r\n        ;[before, middle] = SlateLeaf.split(middle, start.offset - offset)\r\n      }\r\n\r\n      if (collection === 'annotations') {\r\n        middle.annotations[key!] = range\r\n      } else {\r\n        middle.decorations.push(range)\r\n      }\r\n\r\n      if (before) {\r\n        next.push(before)\r\n      }\r\n\r\n      next.push(middle)\r\n\r\n      if (after) {\r\n        next.push(after)\r\n      }\r\n    }\r\n\r\n    leaves = next\r\n  }\r\n\r\n  for (const key in annotations) {\r\n    const range = annotations[key]\r\n    compile('annotations', range, key)\r\n  }\r\n\r\n  for (const range of decorations) {\r\n    compile('decorations', range)\r\n  }\r\n\r\n  return leaves\r\n}\r\n\r\nconst MemoizedText = React.memo(Text, (prev, next) => {\r\n  if (\r\n    next.parent === prev.parent &&\r\n    next.isLast === prev.isLast &&\r\n    next.renderAnnotation === prev.renderAnnotation &&\r\n    next.renderDecoration === prev.renderDecoration &&\r\n    next.renderMark === prev.renderMark &&\r\n    next.text === prev.text\r\n  ) {\r\n    return SlateLeaf.equals(\r\n      {\r\n        ...next.text,\r\n        annotations: next.annotations,\r\n        decorations: next.decorations,\r\n      },\r\n      {\r\n        ...prev.text,\r\n        annotations: prev.annotations,\r\n        decorations: prev.decorations,\r\n      }\r\n    )\r\n  }\r\n\r\n  return false\r\n})\r\n\r\nexport default MemoizedText\r\n","import { createContext, useContext } from 'react'\r\n\r\n/**\r\n * A React context for sharing the `readOnly` state of the editor.\r\n */\r\n\r\nexport const ReadOnlyContext = createContext(false)\r\n\r\n/**\r\n * Get the current `readOnly` state of the editor.\r\n */\r\n\r\nexport const useReadOnly = (): boolean => {\r\n  return useContext(ReadOnlyContext)\r\n}\r\n","import { createContext, useContext } from 'react'\r\n\r\n/**\r\n * A React context for sharing the `selected` state of an element.\r\n */\r\n\r\nexport const SelectedContext = createContext(false)\r\n\r\n/**\r\n * Get the current `selected` state of an element.\r\n */\r\n\r\nexport const useSelected = (): boolean => {\r\n  return useContext(SelectedContext)\r\n}\r\n","import React, { useLayoutEffect, useRef } from 'react'\r\nimport getDirection from 'direction'\r\nimport { Node, Range, NodeEntry, Element as SlateElement } from 'slate'\r\n\r\nimport Text from './text'\r\nimport Children from './children'\r\nimport { useEditor } from '../hooks/use-editor'\r\nimport { useReadOnly } from '../hooks/use-read-only'\r\nimport { SelectedContext } from '../hooks/use-selected'\r\nimport {\r\n  NODE_TO_ELEMENT,\r\n  ELEMENT_TO_NODE,\r\n  NODE_TO_PARENT,\r\n  NODE_TO_INDEX,\r\n  KEY_TO_ELEMENT,\r\n} from '../utils/weak-maps'\r\nimport {\r\n  CustomAnnotationProps,\r\n  CustomDecorationProps,\r\n  CustomElement,\r\n  CustomElementProps,\r\n  CustomMarkProps,\r\n} from './custom'\r\nimport { isRangeListEqual, isRangeMapEqual } from '../utils/leaf'\r\n\r\n/**\r\n * Element.\r\n */\r\n\r\nconst Element = (props: {\r\n  annotations: Record<string, Range>\r\n  decorate: (entry: NodeEntry) => Range[]\r\n  decorations: Range[]\r\n  element: SlateElement\r\n  renderAnnotation?: (props: CustomAnnotationProps) => JSX.Element\r\n  renderDecoration?: (props: CustomDecorationProps) => JSX.Element\r\n  renderElement?: (props: CustomElementProps) => JSX.Element\r\n  renderMark?: (props: CustomMarkProps) => JSX.Element\r\n  selection: Range | null\r\n}) => {\r\n  const {\r\n    annotations,\r\n    decorate,\r\n    decorations,\r\n    element,\r\n    renderAnnotation,\r\n    renderDecoration,\r\n    renderElement = (p: CustomElementProps) => <CustomElement {...p} />,\r\n    renderMark,\r\n    selection,\r\n  } = props\r\n  const ref = useRef<HTMLElement>(null)\r\n  const editor = useEditor()\r\n  const readOnly = useReadOnly()\r\n  const isInline = editor.isInline(element)\r\n  const key = editor.findKey(element)\r\n\r\n  let children: JSX.Element | null = (\r\n    <Children\r\n      annotations={annotations}\r\n      decorate={decorate}\r\n      decorations={decorations}\r\n      node={element}\r\n      renderAnnotation={renderAnnotation}\r\n      renderDecoration={renderDecoration}\r\n      renderElement={renderElement}\r\n      renderMark={renderMark}\r\n      selection={selection}\r\n    />\r\n  )\r\n\r\n  // Attributes that the developer must mix into the element in their\r\n  // custom node renderer component.\r\n  const attributes: {\r\n    'data-slate-node': 'element'\r\n    'data-slate-void'?: true\r\n    'data-slate-inline'?: true\r\n    contentEditable?: false\r\n    dir?: 'rtl'\r\n    ref: any\r\n  } = {\r\n    'data-slate-node': 'element',\r\n    ref,\r\n  }\r\n\r\n  if (isInline) {\r\n    attributes['data-slate-inline'] = true\r\n  }\r\n\r\n  // If it's a block node with inline children, add the proper `dir` attribute\r\n  // for text direction.\r\n  if (!isInline && editor.hasInlines(element)) {\r\n    const text = Node.text(element)\r\n    const dir = getDirection(text)\r\n\r\n    if (dir === 'rtl') {\r\n      attributes.dir = dir\r\n    }\r\n  }\r\n\r\n  // If it's a void node, wrap the children in extra void-specific elements.\r\n  if (editor.isVoid(element)) {\r\n    attributes['data-slate-void'] = true\r\n\r\n    if (!readOnly && isInline) {\r\n      attributes.contentEditable = false\r\n    }\r\n\r\n    const Tag = isInline ? 'span' : 'div'\r\n    const [[text]] = Node.texts(element)\r\n\r\n    children = readOnly ? null : (\r\n      <Tag\r\n        data-slate-spacer\r\n        style={{\r\n          height: '0',\r\n          color: 'transparent',\r\n          outline: 'none',\r\n          position: 'absolute',\r\n        }}\r\n      >\r\n        <Text\r\n          annotations={{}}\r\n          decorations={[]}\r\n          isLast={false}\r\n          parent={element}\r\n          text={text}\r\n        />\r\n      </Tag>\r\n    )\r\n\r\n    NODE_TO_INDEX.set(text, 0)\r\n    NODE_TO_PARENT.set(text, element)\r\n  }\r\n\r\n  // Update element-related weak maps with the DOM element ref.\r\n  useLayoutEffect(() => {\r\n    if (ref.current) {\r\n      KEY_TO_ELEMENT.set(key, ref.current)\r\n      NODE_TO_ELEMENT.set(element, ref.current)\r\n      ELEMENT_TO_NODE.set(ref.current, element)\r\n    } else {\r\n      KEY_TO_ELEMENT.delete(key)\r\n      NODE_TO_ELEMENT.delete(element)\r\n    }\r\n  })\r\n\r\n  return (\r\n    <SelectedContext.Provider value={!!selection}>\r\n      {renderElement({ attributes, children, element })}\r\n    </SelectedContext.Provider>\r\n  )\r\n}\r\n\r\nconst MemoizedElement = React.memo(Element, (prev, next) => {\r\n  return (\r\n    prev.decorate === next.decorate &&\r\n    prev.element === next.element &&\r\n    prev.renderAnnotation === next.renderAnnotation &&\r\n    prev.renderDecoration === next.renderDecoration &&\r\n    prev.renderElement === next.renderElement &&\r\n    prev.renderMark === next.renderMark &&\r\n    isRangeListEqual(prev.decorations, next.decorations) &&\r\n    isRangeMapEqual(prev.annotations, next.annotations) &&\r\n    (prev.selection === next.selection ||\r\n      (!!prev.selection &&\r\n        !!next.selection &&\r\n        Range.equals(prev.selection, next.selection)))\r\n  )\r\n})\r\n\r\nexport default MemoizedElement\r\n","import React from 'react'\r\nimport { Range, Element, NodeEntry, Ancestor, Descendant } from 'slate'\r\n\r\nimport ElementComponent from './element'\r\nimport TextComponent from './text'\r\nimport { useEditor } from '../hooks/use-editor'\r\nimport { NODE_TO_INDEX, NODE_TO_PARENT } from '../utils/weak-maps'\r\nimport {\r\n  CustomAnnotationProps,\r\n  CustomDecorationProps,\r\n  CustomElementProps,\r\n  CustomMarkProps,\r\n} from './custom'\r\n\r\n/**\r\n * Children.\r\n */\r\n\r\nconst Children = (props: {\r\n  annotations: Record<string, Range>\r\n  decorate: (entry: NodeEntry) => Range[]\r\n  decorations: Range[]\r\n  node: Ancestor\r\n  renderAnnotation?: (props: CustomAnnotationProps) => JSX.Element\r\n  renderDecoration?: (props: CustomDecorationProps) => JSX.Element\r\n  renderElement?: (props: CustomElementProps) => JSX.Element\r\n  renderMark?: (props: CustomMarkProps) => JSX.Element\r\n  selection: Range | null\r\n}) => {\r\n  const {\r\n    annotations,\r\n    decorate,\r\n    decorations,\r\n    node,\r\n    renderAnnotation,\r\n    renderDecoration,\r\n    renderElement,\r\n    renderMark,\r\n    selection,\r\n  } = props\r\n  const editor = useEditor()\r\n  const path = editor.findPath(node)\r\n  const children = []\r\n  const isLeafBlock =\r\n    Element.isElement(node) && !editor.isInline(node) && editor.hasInlines(node)\r\n\r\n  for (let i = 0; i < node.children.length; i++) {\r\n    const p = path.concat(i)\r\n    const n = node.children[i] as Descendant\r\n    const key = editor.findKey(n)\r\n    const range = editor.getRange(p)\r\n    const sel = selection && Range.intersection(range, selection)\r\n    const decs = decorate([n, p])\r\n    const anns = {}\r\n\r\n    for (const dec of decorations) {\r\n      const d = Range.intersection(dec, range)\r\n\r\n      if (d) {\r\n        decs.push(d)\r\n      }\r\n    }\r\n\r\n    for (const k in annotations) {\r\n      const ann = annotations[k]\r\n      const a = Range.intersection(ann, range)\r\n\r\n      if (a) {\r\n        anns[k] = a\r\n      }\r\n    }\r\n\r\n    if (Element.isElement(n)) {\r\n      children.push(\r\n        <ElementComponent\r\n          annotations={anns}\r\n          decorate={decorate}\r\n          decorations={decs}\r\n          element={n}\r\n          key={key.id}\r\n          renderAnnotation={renderAnnotation}\r\n          renderDecoration={renderDecoration}\r\n          renderElement={renderElement}\r\n          renderMark={renderMark}\r\n          selection={sel}\r\n        />\r\n      )\r\n    } else {\r\n      children.push(\r\n        <TextComponent\r\n          annotations={anns}\r\n          decorations={decs}\r\n          key={key.id}\r\n          isLast={isLeafBlock && i === node.children.length}\r\n          parent={node}\r\n          renderAnnotation={renderAnnotation}\r\n          renderDecoration={renderDecoration}\r\n          renderMark={renderMark}\r\n          text={n}\r\n        />\r\n      )\r\n    }\r\n\r\n    NODE_TO_INDEX.set(n, i)\r\n    NODE_TO_PARENT.set(n, node)\r\n  }\r\n\r\n  return <React.Fragment>{children}</React.Fragment>\r\n}\r\n\r\nexport default Children\r\n","import { createContext, useContext } from 'react'\r\n\r\n/**\r\n * A React context for sharing the `focused` state of the editor.\r\n */\r\n\r\nexport const FocusedContext = createContext(false)\r\n\r\n/**\r\n * Get the current `focused` state of the editor.\r\n */\r\n\r\nexport const useFocused = (): boolean => {\r\n  return useContext(FocusedContext)\r\n}\r\n","export const IS_IOS =\r\n  typeof navigator !== 'undefined' &&\r\n  typeof window !== 'undefined' &&\r\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\r\n  !window.MSStream\r\n\r\nexport const IS_APPLE =\r\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent)\r\n\r\nexport const IS_FIREFOX =\r\n  typeof navigator !== 'undefined' &&\r\n  /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent)\r\n\r\nexport const IS_SAFARI =\r\n  typeof navigator !== 'undefined' &&\r\n  /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent)\r\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","/**\r\n * Types.\r\n */\r\n\r\nexport type DOMComment = Comment\r\nexport type DOMElement = Element\r\nexport type DOMText = Text\r\nexport type DOMNode = Node\r\nexport type DOMPoint = [Node, number]\r\nexport type DOMRange = Range\r\nexport type DOMSelection = Selection\r\nexport type DOMStaticRange = StaticRange\r\n\r\n/**\r\n * Check if a DOM node is a comment node.\r\n */\r\n\r\nexport const isDOMComment = (value: any): value is DOMComment => {\r\n  return isDOMNode(value) && value.nodeType === 8\r\n}\r\n\r\n/**\r\n * Check if a DOM node is an element node.\r\n */\r\n\r\nexport const isDOMElement = (value: any): value is DOMElement => {\r\n  return isDOMNode(value) && value.nodeType === 1\r\n}\r\n\r\n/**\r\n * Check if a value is a DOM node.\r\n */\r\n\r\nexport const isDOMNode = (value: any): value is DOMNode => {\r\n  return value instanceof Node\r\n}\r\n\r\n/**\r\n * Check if a DOM node is an element node.\r\n */\r\n\r\nexport const isDOMText = (value: any): value is DOMText => {\r\n  return isDOMNode(value) && value.nodeType === 3\r\n}\r\n\r\n/**\r\n * Normalize a DOM point so that it always refers to a text node.\r\n */\r\n\r\nexport const normalizeDOMPoint = (domPoint: DOMPoint): DOMPoint => {\r\n  let [node, offset] = domPoint\r\n\r\n  // If it's an element node, its offset refers to the index of its children\r\n  // including comment nodes, so try to find the right text child node.\r\n  if (isDOMElement(node) && node.childNodes.length) {\r\n    const isLast = offset === node.childNodes.length\r\n    const direction = isLast ? 'backward' : 'forward'\r\n    const index = isLast ? offset - 1 : offset\r\n    node = getEditableChild(node, index, direction)\r\n\r\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\r\n    // can be either text nodes, or other void DOM nodes.\r\n    while (isDOMElement(node) && node.childNodes.length) {\r\n      const i = isLast ? node.childNodes.length - 1 : 0\r\n      node = getEditableChild(node, i, direction)\r\n    }\r\n\r\n    // Determine the new offset inside the text node.\r\n    offset = isLast && node.textContent != null ? node.textContent.length : 0\r\n  }\r\n\r\n  // Return the node and offset.\r\n  return [node, offset]\r\n}\r\n\r\n/**\r\n * Get the nearest editable child at `index` in a `parent`, preferring\r\n * `direction`.\r\n */\r\n\r\nexport const getEditableChild = (\r\n  parent: DOMElement,\r\n  index: number,\r\n  direction: 'forward' | 'backward'\r\n): DOMNode => {\r\n  const { childNodes } = parent\r\n  let child = childNodes[index]\r\n  let i = index\r\n  let triedForward = false\r\n  let triedBackward = false\r\n\r\n  // While the child is a comment node, or an element node with no children,\r\n  // keep iterating to find a sibling non-void, non-comment node.\r\n  while (\r\n    isDOMComment(child) ||\r\n    (isDOMElement(child) && child.childNodes.length === 0) ||\r\n    (isDOMElement(child) && child.getAttribute('contenteditable') === 'false')\r\n  ) {\r\n    if (triedForward && triedBackward) {\r\n      break\r\n    }\r\n\r\n    if (i >= childNodes.length) {\r\n      triedForward = true\r\n      i = index - 1\r\n      direction = 'backward'\r\n      continue\r\n    }\r\n\r\n    if (i < 0) {\r\n      triedBackward = true\r\n      i = index + 1\r\n      direction = 'forward'\r\n      continue\r\n    }\r\n\r\n    child = childNodes[i]\r\n    i += direction === 'forward' ? 1 : -1\r\n  }\r\n\r\n  return child\r\n}\r\n","import {\r\n  Range as SlateRange,\r\n  Node as SlateNode,\r\n  Descendant as SlateDescendant,\r\n} from 'slate'\r\n\r\nimport { ReactEditor } from '../plugin'\r\nimport { isDOMText, isDOMElement, DOMNode } from './dom'\r\n\r\nnamespace Utils {\r\n  /**\r\n   * Get the fragment data from a `DataTransfer` object.\r\n   */\r\n\r\n  export const getFragmentData = (\r\n    dataTransfer: DataTransfer\r\n  ): SlateDescendant[] | undefined => {\r\n    const base64 = dataTransfer.getData('application/x-slate-fragment')\r\n\r\n    if (base64) {\r\n      const decoded = decodeURIComponent(window.atob(base64))\r\n      const fragment = JSON.parse(decoded)\r\n      return fragment\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set the currently selected fragment to the clipboard.\r\n   */\r\n\r\n  export const setFragmentData = (\r\n    dataTransfer: DataTransfer,\r\n    editor: ReactEditor\r\n  ): void => {\r\n    const { value } = editor\r\n    const { selection } = value\r\n\r\n    if (!selection) {\r\n      return\r\n    }\r\n\r\n    const [start, end] = SlateRange.edges(selection)\r\n    const startVoid = editor.getMatch(start.path, 'void')\r\n    const endVoid = editor.getMatch(end.path, 'void')\r\n\r\n    if (SlateRange.isCollapsed(selection) && !startVoid) {\r\n      return\r\n    }\r\n\r\n    // Create a fake selection so that we can add a Base64-encoded copy of the\r\n    // fragment to the HTML, to decode on future pastes.\r\n    const domRange = editor.toDomRange(selection)\r\n    let contents = domRange.cloneContents()\r\n    let attach = contents.childNodes[0] as HTMLElement\r\n\r\n    // Make sure attach is non-empty, since empty nodes will not get copied.\r\n    contents.childNodes.forEach(node => {\r\n      if (node.textContent && node.textContent.trim() !== '') {\r\n        attach = node as HTMLElement\r\n      }\r\n    })\r\n\r\n    // COMPAT: If the end node is a void node, we need to move the end of the\r\n    // range from the void node's spacer span, to the end of the void node's\r\n    // content, since the spacer is before void's content in the DOM.\r\n    if (endVoid) {\r\n      const [voidNode] = endVoid\r\n      const r = domRange.cloneRange()\r\n      const domNode = editor.toDomNode(voidNode)\r\n      r.setEndAfter(domNode)\r\n      contents = r.cloneContents()\r\n    }\r\n\r\n    // COMPAT: If the start node is a void node, we need to attach the encoded\r\n    // fragment to the void node's content node instead of the spacer, because\r\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\r\n    // most browsers. (2018/04/27)\r\n    if (startVoid) {\r\n      attach = contents.querySelector('[data-slate-spacer]')! as HTMLElement\r\n    }\r\n\r\n    // Remove any zero-width space spans from the cloned DOM so that they don't\r\n    // show up elsewhere when pasted.\r\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(\r\n      zw => {\r\n        const isNewline = zw.getAttribute('data-slate-zero-width') === 'n'\r\n        zw.textContent = isNewline ? '\\n' : ''\r\n      }\r\n    )\r\n\r\n    // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\r\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\r\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\r\n    if (isDOMText(attach)) {\r\n      const span = document.createElement('span')\r\n      // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\r\n      // then leading and trailing spaces will be ignored. (2017/09/21)\r\n      span.style.whiteSpace = 'pre'\r\n      span.appendChild(attach)\r\n      contents.appendChild(span)\r\n      attach = span\r\n    }\r\n\r\n    const fragment = SlateNode.fragment(value, selection)\r\n    const string = JSON.stringify(fragment)\r\n    const encoded = window.btoa(encodeURIComponent(string))\r\n    attach.setAttribute('data-slate-fragment', encoded)\r\n    dataTransfer.setData('application/x-slate-fragment', encoded)\r\n\r\n    // Add the content to a <div> so that we can get its inner HTML.\r\n    const div = document.createElement('div')\r\n    div.appendChild(contents)\r\n    dataTransfer.setData('text/html', div.innerHTML)\r\n    dataTransfer.setData('text/plain', getPlainText(div))\r\n  }\r\n}\r\n\r\n/**\r\n * Get a plaintext representation of the content of a node, accounting for block\r\n * elements which get a newline appended.\r\n */\r\n\r\nconst getPlainText = (domNode: DOMNode) => {\r\n  let text = ''\r\n\r\n  if (isDOMText(domNode) && domNode.nodeValue) {\r\n    return domNode.nodeValue\r\n  }\r\n\r\n  if (isDOMElement(domNode)) {\r\n    for (const childNode of Array.from(domNode.childNodes)) {\r\n      text += getPlainText(childNode)\r\n    }\r\n\r\n    const display = getComputedStyle(domNode).getPropertyValue('display')\r\n\r\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\r\n      text += '\\n'\r\n    }\r\n  }\r\n\r\n  return text\r\n}\r\n\r\nexport { Utils }\r\n","import React, { useLayoutEffect, useRef, useMemo, useCallback } from 'react'\r\nimport {\r\n  Value,\r\n  Element,\r\n  NodeEntry,\r\n  Range as SlateRange,\r\n  Operation,\r\n} from 'slate'\r\nimport debounce from 'debounce'\r\nimport scrollIntoView from 'scroll-into-view-if-needed'\r\n\r\nimport Children from './children'\r\nimport { EditorContext } from '../hooks/use-editor'\r\nimport { FocusedContext } from '../hooks/use-focused'\r\nimport { IS_FIREFOX, IS_SAFARI } from '../utils/environment'\r\nimport { ReactEditor } from '../plugin'\r\nimport { ReadOnlyContext } from '../hooks/use-read-only'\r\nimport {\r\n  DOMElement,\r\n  DOMNode,\r\n  DOMRange,\r\n  isDOMElement,\r\n  isDOMNode,\r\n  DOMStaticRange,\r\n} from '../utils/dom'\r\nimport {\r\n  EDITOR_TO_ELEMENT,\r\n  ELEMENT_TO_NODE,\r\n  IS_READ_ONLY,\r\n  NODE_TO_ELEMENT,\r\n  IS_FOCUSED,\r\n  PLACEHOLDER,\r\n} from '../utils/weak-maps'\r\nimport { Utils } from '../utils/utils'\r\nimport {\r\n  CustomAnnotationProps,\r\n  CustomDecorationProps,\r\n  CustomElementProps,\r\n  CustomMarkProps,\r\n} from './custom'\r\n\r\n/**\r\n * Editor.\r\n */\r\n\r\nconst Editor = (props: {\r\n  decorate?: (entry: NodeEntry) => SlateRange[]\r\n  editor: ReactEditor\r\n  onChange: (value: Value, operations: Operation[]) => void\r\n  placeholder?: string\r\n  readOnly?: boolean\r\n  role?: string\r\n  style?: Record<string, any>\r\n  renderAnnotation?: (props: CustomAnnotationProps) => JSX.Element\r\n  renderDecoration?: (props: CustomDecorationProps) => JSX.Element\r\n  renderElement?: (props: CustomElementProps) => JSX.Element\r\n  renderMark?: (props: CustomMarkProps) => JSX.Element\r\n  value: Value\r\n  [key: string]: any\r\n}) => {\r\n  const {\r\n    decorate = defaultDecorate,\r\n    editor,\r\n    value,\r\n    onChange,\r\n    placeholder,\r\n    readOnly = false,\r\n    renderAnnotation,\r\n    renderDecoration,\r\n    renderElement,\r\n    renderMark,\r\n    style = {},\r\n    ...attributes\r\n  } = props\r\n\r\n  if (!Value.isValue(value)) {\r\n    throw new Error(\r\n      `The \\`value=\\` prop you passed to <Editor> was not a valid Slate value: ${JSON.stringify(\r\n        value\r\n      )}`\r\n    )\r\n  }\r\n\r\n  const ref = useRef<HTMLDivElement>(null)\r\n\r\n  // Update internal state on each render.\r\n  editor.onChange = onChange\r\n  editor.value = value\r\n  PLACEHOLDER.set(editor, placeholder)\r\n  IS_READ_ONLY.set(editor, readOnly)\r\n\r\n  // Keep track of some state for the event handler logic.\r\n  const state = useMemo(\r\n    () => ({\r\n      isComposing: false,\r\n      isUpdatingSelection: false,\r\n      latestElement: null as DOMElement | null,\r\n    }),\r\n    []\r\n  )\r\n\r\n  // Update element-related weak maps with the DOM element ref.\r\n  useLayoutEffect(() => {\r\n    if (ref.current) {\r\n      EDITOR_TO_ELEMENT.set(editor, ref.current)\r\n      NODE_TO_ELEMENT.set(value, ref.current)\r\n      ELEMENT_TO_NODE.set(ref.current, value)\r\n    } else {\r\n      NODE_TO_ELEMENT.delete(value)\r\n    }\r\n  })\r\n\r\n  // Attach a native DOM event handler for `selectionchange`, because React's\r\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\r\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\r\n  // fire for any change to the selection inside the editor. (2019/11/04)\r\n  // https://github.com/facebook/react/issues/5785\r\n  useLayoutEffect(() => {\r\n    window.document.addEventListener('selectionchange', onDOMSelectionChange)\r\n\r\n    return () => {\r\n      window.document.removeEventListener(\r\n        'selectionchange',\r\n        onDOMSelectionChange\r\n      )\r\n    }\r\n  }, [])\r\n\r\n  // Attach a native DOM event handler for `beforeinput` events, because React's\r\n  // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\r\n  // real `beforeinput` events sadly... (2019/11/04)\r\n  // https://github.com/facebook/react/issues/11211\r\n  useLayoutEffect(() => {\r\n    if (ref.current) {\r\n      // @ts-ignore The `beforeinput` event isn't recognized.\r\n      ref.current.addEventListener('beforeinput', onDOMBeforeInput)\r\n    }\r\n\r\n    return () => {\r\n      if (ref.current) {\r\n        // @ts-ignore The `beforeinput` event isn't recognized.\r\n        ref.current.removeEventListener('beforeinput', onDOMBeforeInput)\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  // Whenever the editor updates, make sure the DOM selection state is in sync.\r\n  useLayoutEffect(() => {\r\n    const { selection } = value\r\n    const domSelection = window.getSelection()\r\n\r\n    if (state.isComposing || !domSelection || !editor.isFocused()) {\r\n      return\r\n    }\r\n\r\n    const el = editor.toDomNode(value)\r\n    const domRange = domSelection.getRangeAt(0)\r\n    const newDomRange = selection && editor.toDomRange(selection)\r\n\r\n    if (\r\n      (!selection && !domRange) ||\r\n      (domRange && newDomRange && isRangeEqual(domRange, newDomRange))\r\n    ) {\r\n      return\r\n    }\r\n\r\n    state.isUpdatingSelection = true\r\n    domSelection.removeAllRanges()\r\n\r\n    if (newDomRange) {\r\n      domSelection.addRange(newDomRange!)\r\n      const leafEl = newDomRange.startContainer.parentElement!\r\n      scrollIntoView(leafEl, { scrollMode: 'if-needed' })\r\n    }\r\n\r\n    setTimeout(() => {\r\n      // COMPAT: In Firefox, it's not enough to create a range, you also need\r\n      // to focus the contenteditable element too. (2016/11/16)\r\n      if (newDomRange && IS_FIREFOX) {\r\n        el.focus()\r\n      }\r\n\r\n      state.isUpdatingSelection = false\r\n    })\r\n  })\r\n\r\n  // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\r\n  // is required because React's `beforeinput` is fake and never really attaches\r\n  // to the real event sadly. (2019/11/01)\r\n  // https://github.com/facebook/react/issues/11211\r\n  const onDOMBeforeInput = useCallback(\r\n    (\r\n      event: Event & {\r\n        data: string | null\r\n        dataTransfer: DataTransfer | null\r\n        getTargetRanges(): DOMStaticRange[]\r\n        inputType: string\r\n        isComposing: boolean\r\n      }\r\n    ) => {\r\n      if (!readOnly && hasEditableTarget(editor, event.target)) {\r\n        const { inputType } = event\r\n        const data = event.dataTransfer || event.data || undefined\r\n\r\n        // These two types occur while a user is composing text and can't be\r\n        // cancelled. Let them through and wait for the composition to end.\r\n        if (\r\n          inputType === 'insertCompositionText' ||\r\n          inputType === 'deleteCompositionText'\r\n        ) {\r\n          return\r\n        }\r\n\r\n        const [targetRange] = event.getTargetRanges()\r\n        let range\r\n\r\n        if (targetRange) {\r\n          range = editor.toSlateRange(targetRange)\r\n        }\r\n\r\n        event.preventDefault()\r\n        editor.handleInput(inputType, data, range)\r\n      }\r\n    },\r\n    []\r\n  )\r\n\r\n  // Listen on the native `selectionchange` event to be able to update any time\r\n  // the selection changes. This is required because React's `onSelect` is leaky\r\n  // and non-standard so it doesn't fire until after a selection has been\r\n  // released. This causes issues in situations where another change happens\r\n  // while a selection is being dragged.\r\n  const onDOMSelectionChange = useCallback(\r\n    debounce(() => {\r\n      if (!readOnly && !state.isComposing && !state.isUpdatingSelection) {\r\n        const { activeElement } = window.document\r\n        const el = editor.toDomNode(value)\r\n        const domSelection = window.getSelection()\r\n        const domRange =\r\n          domSelection &&\r\n          domSelection.rangeCount > 0 &&\r\n          domSelection.getRangeAt(0)\r\n\r\n        if (activeElement === el) {\r\n          state.latestElement = activeElement\r\n          IS_FOCUSED.set(editor, true)\r\n        } else {\r\n          IS_FOCUSED.delete(editor)\r\n        }\r\n\r\n        if (\r\n          domRange &&\r\n          hasEditableTarget(editor, domRange.startContainer) &&\r\n          hasEditableTarget(editor, domRange.endContainer)\r\n        ) {\r\n          const range = editor.toSlateRange(domRange)\r\n          editor.select(range)\r\n        } else {\r\n          editor.deselect()\r\n        }\r\n      }\r\n    }, 100),\r\n    []\r\n  )\r\n\r\n  return (\r\n    <EditorContext.Provider value={editor}>\r\n      <ReadOnlyContext.Provider value={readOnly}>\r\n        <FocusedContext.Provider value={editor.isFocused()}>\r\n          <div\r\n            // COMPAT: The Grammarly Chrome extension works by changing the DOM\r\n            // out from under `contenteditable` elements, which leads to weird\r\n            // behaviors so we have to disable it like editor. (2017/04/24)\r\n            data-gramm={false}\r\n            role={readOnly ? undefined : 'textbox'}\r\n            {...attributes}\r\n            // COMPAT: Firefox doesn't support the `beforeinput` event, so we'd\r\n            // have to use hacks to make these replacement-based features work.\r\n            spellCheck={IS_FIREFOX ? undefined : attributes.spellCheck}\r\n            autoCorrect={IS_FIREFOX ? undefined : attributes.autoCorrect}\r\n            autoCapitalize={IS_FIREFOX ? undefined : attributes.autoCapitalize}\r\n            data-slate-editor\r\n            data-slate-node=\"value\"\r\n            contentEditable={readOnly ? undefined : true}\r\n            suppressContentEditableWarning\r\n            ref={ref}\r\n            style={{\r\n              // Prevent the default outline styles.\r\n              outline: 'none',\r\n              // Preserve adjacent whitespace and new lines.\r\n              whiteSpace: 'pre-wrap',\r\n              // Allow words to break if they are too long.\r\n              wordWrap: 'break-word',\r\n              // Allow for passed-in styles to override anything.\r\n              ...style,\r\n            }}\r\n            onBeforeInput={useCallback((event: React.SyntheticEvent) => {\r\n              // COMPAT: Firefox doesn't support the `beforeinput` event, so we\r\n              // fall back to React's leaky polyfill instead just for it. It\r\n              // only works for the `insertText` input type.\r\n              if (IS_FIREFOX && !readOnly) {\r\n                event.preventDefault()\r\n                const text = (event as any).data as string\r\n                editor.handleInput('insertText', text)\r\n              }\r\n            }, [])}\r\n            onBlur={useCallback((event: React.FocusEvent) => {\r\n              if (\r\n                !readOnly &&\r\n                !state.isUpdatingSelection &&\r\n                hasEditableTarget(editor, event.target) &&\r\n                // COMPAT: If the current `activeElement` is still the previous\r\n                // one, this is due to the window being blurred when the tab\r\n                // itself becomes unfocused, so we want to abort early to allow to\r\n                // editor to stay focused when the tab becomes focused again.\r\n                state.latestElement !== window.document.activeElement\r\n              ) {\r\n                const { relatedTarget } = event\r\n\r\n                // COMPAT: The `relatedTarget` can be null when the new focus target\r\n                // is not a \"focusable\" element (eg. a `<div>` without `tabindex`\r\n                // set).\r\n                if (relatedTarget) {\r\n                  const el = editor.toDomNode(value)\r\n\r\n                  // COMPAT: The event should be ignored if the focus is returning\r\n                  // to the editor from an embedded editable element (eg. an <input>\r\n                  // element inside a void node).\r\n                  if (relatedTarget === el) return\r\n\r\n                  if (isDOMElement(relatedTarget)) {\r\n                    // COMPAT: The event should be ignored if the focus is moving from\r\n                    // the editor to inside a void node's spacer element.\r\n                    if (relatedTarget.hasAttribute('data-slate-spacer')) return\r\n\r\n                    // COMPAT: The event should be ignored if the focus is moving to a\r\n                    // non- editable section of an element that isn't a void node (eg.\r\n                    // a list item of the check list example).\r\n                    const node = editor.toSlateNode(relatedTarget)\r\n\r\n                    if (\r\n                      editor.hasDomNode(relatedTarget) &&\r\n                      (!Element.isElement(node) || !editor.isVoid(node))\r\n                    ) {\r\n                      return\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n\r\n              IS_FOCUSED.delete(editor)\r\n            }, [])}\r\n            onClick={useCallback((event: React.MouseEvent) => {\r\n              if (\r\n                !readOnly &&\r\n                hasTarget(editor, event.target) &&\r\n                isDOMNode(event.target)\r\n              ) {\r\n                const node = editor.toSlateNode(event.target)\r\n                const path = editor.findPath(node)\r\n                const start = editor.getStart(path)\r\n\r\n                if (editor.getMatch(start, 'void')) {\r\n                  editor.select(start)\r\n                }\r\n              }\r\n            }, [])}\r\n            onCompositionEnd={useCallback((event: React.CompositionEvent) => {\r\n              if (hasEditableTarget(editor, event.target)) {\r\n                state.isComposing = false\r\n\r\n                // COMPAT: In Chrome, `beforeinput` events for compositions\r\n                // aren't correct and never fire the \"insertFromComposition\"\r\n                // type that we need. So instead, insert whenever a composition\r\n                // ends since it will already have been committed to the DOM.\r\n                if (!IS_SAFARI && event.data) {\r\n                  editor.insertText(event.data)\r\n                }\r\n              }\r\n            }, [])}\r\n            onCompositionStart={useCallback((event: React.CompositionEvent) => {\r\n              if (hasEditableTarget(editor, event.target)) {\r\n                state.isComposing = true\r\n              }\r\n            }, [])}\r\n            onCopy={useCallback((event: React.ClipboardEvent) => {\r\n              if (hasEditableTarget(editor, event.target)) {\r\n                event.preventDefault()\r\n                Utils.setFragmentData(event.clipboardData, editor)\r\n              }\r\n            }, [])}\r\n            onCut={useCallback((event: React.ClipboardEvent) => {\r\n              if (!readOnly && hasEditableTarget(editor, event.target)) {\r\n                event.preventDefault()\r\n                Utils.setFragmentData(event.clipboardData, editor)\r\n                const { selection } = value\r\n\r\n                if (selection && SlateRange.isExpanded(selection)) {\r\n                  editor.delete()\r\n                }\r\n              }\r\n            }, [])}\r\n            onDragOver={useCallback((event: React.DragEvent) => {\r\n              if (hasTarget(editor, event.target)) {\r\n                // Only when the target is void, call `preventDefault` to signal\r\n                // that drops are allowed. Editable content is droppable by\r\n                // default, and calling `preventDefault` hides the cursor.\r\n                const node = editor.toSlateNode(event.target)\r\n\r\n                if (Element.isElement(node) && editor.isVoid(node)) {\r\n                  event.preventDefault()\r\n                }\r\n              }\r\n            }, [])}\r\n            onDragStart={useCallback((event: React.DragEvent) => {\r\n              if (hasTarget(editor, event.target)) {\r\n                const node = editor.toSlateNode(event.target)\r\n                const path = editor.findPath(node)\r\n                const voidMatch = editor.getMatch(path, 'void')\r\n\r\n                // If starting a drag on a void node, make sure it is selected\r\n                // so that it shows up in the selection's fragment.\r\n                if (voidMatch) {\r\n                  const range = editor.getRange(path)\r\n                  editor.select(range)\r\n                }\r\n\r\n                Utils.setFragmentData(event.dataTransfer, editor)\r\n              }\r\n            }, [])}\r\n            onFocus={useCallback((event: React.FocusEvent) => {\r\n              if (\r\n                !readOnly &&\r\n                !state.isUpdatingSelection &&\r\n                hasEditableTarget(editor, event.target)\r\n              ) {\r\n                const el = editor.toDomNode(value)\r\n                state.latestElement = window.document.activeElement\r\n\r\n                // COMPAT: If the editor has nested editable elements, the focus\r\n                // can go to them. In Firefox, this must be prevented because it\r\n                // results in issues with keyboard navigation. (2017/03/30)\r\n                if (IS_FIREFOX && event.target !== el) {\r\n                  el.focus()\r\n                  return\r\n                }\r\n\r\n                IS_FOCUSED.set(editor, true)\r\n              }\r\n            }, [])}\r\n            onKeyDown={event => {\r\n              if (!readOnly && hasEditableTarget(editor, event.target)) {\r\n                editor.onKeyDown(event.nativeEvent)\r\n              }\r\n            }}\r\n            onPaste={useCallback((event: React.ClipboardEvent) => {\r\n              // COMPAT: Firefox doesn't support the `beforeinput` event, so we\r\n              // fall back to React's `onPaste` here instead.\r\n              if (\r\n                IS_FIREFOX &&\r\n                !readOnly &&\r\n                hasEditableTarget(editor, event.target)\r\n              ) {\r\n                event.preventDefault()\r\n                editor.handleInput('insertFromPaste', event.clipboardData)\r\n              }\r\n            }, [])}\r\n          >\r\n            <Children\r\n              annotations={value.annotations}\r\n              decorate={decorate}\r\n              decorations={decorate([value, []])}\r\n              node={value}\r\n              renderAnnotation={renderAnnotation}\r\n              renderDecoration={renderDecoration}\r\n              renderElement={renderElement}\r\n              renderMark={renderMark}\r\n              selection={value.selection}\r\n            />\r\n          </div>\r\n        </FocusedContext.Provider>\r\n      </ReadOnlyContext.Provider>\r\n    </EditorContext.Provider>\r\n  )\r\n}\r\n\r\n/**\r\n * A default memoized decorate function.\r\n */\r\n\r\nconst defaultDecorate = () => []\r\n\r\n/**\r\n * Check if two DOM range objects are equal.\r\n */\r\n\r\nconst isRangeEqual = (a: DOMRange, b: DOMRange) => {\r\n  return (\r\n    (a.startContainer === b.startContainer &&\r\n      a.startOffset === b.startOffset &&\r\n      a.endContainer === b.endContainer &&\r\n      a.endOffset === b.endOffset) ||\r\n    (a.startContainer === b.endContainer &&\r\n      a.startOffset === b.endOffset &&\r\n      a.endContainer === b.startContainer &&\r\n      a.endOffset === b.startOffset)\r\n  )\r\n}\r\n\r\n/**\r\n * Check if the target is in the editor.\r\n */\r\n\r\nconst hasTarget = (\r\n  editor: ReactEditor,\r\n  target: EventTarget | null\r\n): target is DOMNode => {\r\n  return isDOMNode(target) && editor.hasDomNode(target)\r\n}\r\n\r\n/**\r\n * Check if the target is editable and in the editor.\r\n */\r\n\r\nconst hasEditableTarget = (\r\n  editor: ReactEditor,\r\n  target: EventTarget | null\r\n): target is DOMNode => {\r\n  return isDOMNode(target) && editor.hasDomNode(target, { editable: true })\r\n}\r\n\r\nexport default Editor\r\n","import { useMemo } from 'react'\r\n\r\nimport { ReactEditor } from '../plugin'\r\n\r\n/**\r\n * A thin wrapper around `useMemo` to make it easy to get an editor instance.\r\n */\r\n\r\nexport const useSlate = <E extends ReactEditor>(\r\n  Editor: new (...args: any[]) => E\r\n): E => {\r\n  const editor = useMemo(() => new Editor(), [Editor])\r\n  return editor\r\n}\r\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","import { isKeyHotkey } from 'is-hotkey'\r\nimport { IS_APPLE } from './environment'\r\n\r\n/**\r\n * Hotkey mappings for each platform.\r\n */\r\n\r\nconst HOTKEYS = {\r\n  bold: 'mod+b',\r\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\r\n  moveBackward: 'left',\r\n  moveForward: 'right',\r\n  moveWordBackward: 'ctrl+left',\r\n  moveWordForward: 'ctrl+right',\r\n  deleteBackward: 'shift?+backspace',\r\n  deleteForward: 'shift?+delete',\r\n  extendBackward: 'shift+left',\r\n  extendForward: 'shift+right',\r\n  italic: 'mod+i',\r\n  splitBlock: 'shift?+enter',\r\n  undo: 'mod+z',\r\n}\r\n\r\nconst APPLE_HOTKEYS = {\r\n  moveLineBackward: 'opt+up',\r\n  moveLineForward: 'opt+down',\r\n  moveWordBackward: 'opt+left',\r\n  moveWordForward: 'opt+right',\r\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\r\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\r\n  deleteLineBackward: 'cmd+shift?+backspace',\r\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\r\n  deleteWordBackward: 'opt+shift?+backspace',\r\n  deleteWordForward: 'opt+shift?+delete',\r\n  extendLineBackward: 'opt+shift+up',\r\n  extendLineForward: 'opt+shift+down',\r\n  redo: 'cmd+shift+z',\r\n  transposeCharacter: 'ctrl+t',\r\n}\r\n\r\nconst WINDOWS_HOTKEYS = {\r\n  deleteWordBackward: 'ctrl+shift?+backspace',\r\n  deleteWordForward: 'ctrl+shift?+delete',\r\n  redo: ['ctrl+y', 'ctrl+shift+z'],\r\n}\r\n\r\n/**\r\n * Create a platform-aware hotkey checker.\r\n */\r\n\r\nconst create = (key: string) => {\r\n  const generic = HOTKEYS[key]\r\n  const apple = APPLE_HOTKEYS[key]\r\n  const windows = WINDOWS_HOTKEYS[key]\r\n  const isGeneric = generic && isKeyHotkey(generic)\r\n  const isApple = apple && isKeyHotkey(apple)\r\n  const isWindows = windows && isKeyHotkey(windows)\r\n\r\n  return (event: KeyboardEvent) => {\r\n    if (isGeneric && isGeneric(event)) return true\r\n    if (IS_APPLE && isApple && isApple(event)) return true\r\n    if (!IS_APPLE && isWindows && isWindows(event)) return true\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Hotkeys.\r\n */\r\n\r\nexport default {\r\n  isBold: create('bold'),\r\n  isCompose: create('compose'),\r\n  isMoveBackward: create('moveBackward'),\r\n  isMoveForward: create('moveForward'),\r\n  isDeleteBackward: create('deleteBackward'),\r\n  isDeleteForward: create('deleteForward'),\r\n  isDeleteLineBackward: create('deleteLineBackward'),\r\n  isDeleteLineForward: create('deleteLineForward'),\r\n  isDeleteWordBackward: create('deleteWordBackward'),\r\n  isDeleteWordForward: create('deleteWordForward'),\r\n  isExtendBackward: create('extendBackward'),\r\n  isExtendForward: create('extendForward'),\r\n  isExtendLineBackward: create('extendLineBackward'),\r\n  isExtendLineForward: create('extendLineForward'),\r\n  isItalic: create('italic'),\r\n  isMoveLineBackward: create('moveLineBackward'),\r\n  isMoveLineForward: create('moveLineForward'),\r\n  isMoveWordBackward: create('moveWordBackward'),\r\n  isMoveWordForward: create('moveWordForward'),\r\n  isRedo: create('redo'),\r\n  isSplitBlock: create('splitBlock'),\r\n  isTransposeCharacter: create('transposeCharacter'),\r\n  isUndo: create('undo'),\r\n}\r\n","/**\r\n * An auto-incrementing identifier for keys.\r\n */\r\n\r\nlet n = 0\r\n\r\n/**\r\n * A class that keeps track of a key string. We use a full class here because we\r\n * want to be able to use them as keys in `WeakMap` objects.\r\n */\r\n\r\nexport class Key {\r\n  id: string\r\n\r\n  constructor() {\r\n    this.id = `${n++}`\r\n  }\r\n}\r\n","import {\r\n  Editor,\r\n  Element as SlateElement,\r\n  Node as SlateNode,\r\n  Operation as SlateOperation,\r\n  Path as SlatePath,\r\n  Point as SlatePoint,\r\n  Range as SlateRange,\r\n  Value as SlateValue,\r\n  Path,\r\n} from 'slate'\r\n\r\nimport Hotkeys from './utils/hotkeys'\r\nimport { Key } from './utils/key'\r\nimport { Utils } from './utils/utils'\r\nimport {\r\n  EDITOR_TO_ELEMENT,\r\n  ELEMENT_TO_NODE,\r\n  IS_FOCUSED,\r\n  IS_READ_ONLY,\r\n  KEY_TO_ELEMENT,\r\n  NODE_TO_INDEX,\r\n  NODE_TO_KEY,\r\n  NODE_TO_PARENT,\r\n  PLACEHOLDER,\r\n  PLACEHOLDER_SYMBOL,\r\n} from './utils/weak-maps'\r\nimport {\r\n  DOMElement,\r\n  DOMNode,\r\n  DOMPoint,\r\n  DOMRange,\r\n  DOMSelection,\r\n  DOMStaticRange,\r\n  isDOMElement,\r\n  normalizeDOMPoint,\r\n} from './utils/dom'\r\n\r\n/**\r\n * `ReactEditor` is a Slate editor interface with the React mixin applied.\r\n */\r\n\r\nexport type ReactEditor = InstanceType<ReturnType<typeof withReact>>\r\n\r\n/**\r\n * `withReact` adds React and DOM specific behaviors to the editor.\r\n */\r\n\r\nexport const withReact = (Editor: new (...args: any[]) => Editor) => {\r\n  return class ReactEditor extends Editor {\r\n    apply(op: SlateOperation): void {\r\n      const matches: [SlatePath, Key][] = []\r\n\r\n      switch (op.type) {\r\n        case 'add_mark':\r\n        case 'insert_text':\r\n        case 'remove_mark':\r\n        case 'remove_text':\r\n        case 'set_mark':\r\n        case 'set_node': {\r\n          for (const [node, path] of this.levels({ at: op.path })) {\r\n            const key = this.findKey(node)\r\n            matches.push([path, key])\r\n          }\r\n\r\n          break\r\n        }\r\n\r\n        case 'insert_node':\r\n        case 'remove_node':\r\n        case 'merge_node':\r\n        case 'split_node': {\r\n          for (const [node, path] of this.levels({\r\n            at: Path.parent(op.path),\r\n          })) {\r\n            const key = this.findKey(node)\r\n            matches.push([path, key])\r\n          }\r\n\r\n          break\r\n        }\r\n\r\n        case 'move_node': {\r\n          // TODO\r\n          break\r\n        }\r\n      }\r\n\r\n      super.apply(op)\r\n\r\n      for (const [path, key] of matches) {\r\n        const [node] = this.getNode(path)\r\n        NODE_TO_KEY.set(node, key)\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Find a key for a Slate node.\r\n     */\r\n\r\n    findKey(node: SlateNode): Key {\r\n      let key = NODE_TO_KEY.get(node)\r\n\r\n      if (!key) {\r\n        key = new Key()\r\n        NODE_TO_KEY.set(node, key)\r\n      }\r\n\r\n      return key\r\n    }\r\n\r\n    /**\r\n     * Find the path of Slate node.\r\n     */\r\n\r\n    findPath(node: SlateNode): SlatePath {\r\n      const path: SlatePath = []\r\n      let child = node\r\n\r\n      while (true) {\r\n        const parent = NODE_TO_PARENT.get(child)\r\n\r\n        if (parent == null) {\r\n          if (SlateValue.isValue(child)) {\r\n            return path\r\n          } else {\r\n            break\r\n          }\r\n        }\r\n\r\n        const i = NODE_TO_INDEX.get(child)\r\n\r\n        if (i == null) {\r\n          break\r\n        }\r\n\r\n        path.unshift(i)\r\n        child = parent\r\n      }\r\n\r\n      throw new Error(\r\n        `Unable to find the path for Slate node: ${JSON.stringify(node)}`\r\n      )\r\n    }\r\n\r\n    /**\r\n     * Resolve the decorations for a node.\r\n     */\r\n\r\n    getDecorations(node: SlateNode): SlateRange[] {\r\n      const placeholder = PLACEHOLDER.get(this)\r\n      const decorations = []\r\n\r\n      if (\r\n        placeholder &&\r\n        SlateValue.isValue(node) &&\r\n        node.children.length === 1 &&\r\n        Array.from(SlateNode.texts(node)).length === 1 &&\r\n        SlateNode.text(node) === ''\r\n      ) {\r\n        const start = this.getStart([])\r\n\r\n        decorations.push({\r\n          [PLACEHOLDER_SYMBOL]: true,\r\n          placeholder,\r\n          anchor: start,\r\n          focus: start,\r\n        })\r\n      }\r\n\r\n      return decorations\r\n    }\r\n\r\n    /**\r\n     * Transform an `InputEvent` into commands on the editor.\r\n     */\r\n\r\n    handleInput(\r\n      type: string,\r\n      data?: DataTransfer | string,\r\n      range?: SlateRange\r\n    ): void {\r\n      // Each of these input types reflects specific user intent, and most of them\r\n      // are cancellable so we can perform the action on the Slate model direclty.\r\n      // https://w3c.github.io/input-events/#dom-inputevent-inputtype\r\n      switch (type) {\r\n        case 'deleteByComposition':\r\n        case 'deleteByCut':\r\n        case 'deleteByDrag':\r\n        case 'deleteContent':\r\n        case 'deleteContentForward': {\r\n          this.delete()\r\n          break\r\n        }\r\n\r\n        case 'deleteContentBackward': {\r\n          this.delete({ reverse: true })\r\n          break\r\n        }\r\n\r\n        case 'deleteEntireSoftLine': {\r\n          this.delete({ unit: 'line', reverse: true })\r\n          this.delete({ unit: 'line' })\r\n          break\r\n        }\r\n\r\n        case 'deleteSoftLineBackward':\r\n        case 'deleteHardLineBackward': {\r\n          this.delete({ unit: 'line', reverse: true })\r\n          break\r\n        }\r\n\r\n        case 'deleteSoftLineForward':\r\n        case 'deleteHardLineForward': {\r\n          this.delete({ unit: 'line' })\r\n          break\r\n        }\r\n\r\n        case 'deleteWordBackward': {\r\n          this.delete({ unit: 'word', reverse: true })\r\n          break\r\n        }\r\n\r\n        case 'deleteWordForward': {\r\n          this.delete({ unit: 'word' })\r\n          break\r\n        }\r\n\r\n        case 'insertLineBreak':\r\n        case 'insertParagraph': {\r\n          if (range) {\r\n            this.select(range)\r\n          }\r\n\r\n          this.splitNodes({ always: true })\r\n          break\r\n        }\r\n\r\n        case 'insertFromComposition':\r\n        case 'insertFromDrop':\r\n        case 'insertFromPaste':\r\n        case 'insertFromYank':\r\n        case 'insertReplacementText':\r\n        case 'insertText': {\r\n          if (range) {\r\n            this.select(range)\r\n          }\r\n\r\n          if (data instanceof DataTransfer) {\r\n            this.insertData(data)\r\n          } else if (typeof data === 'string') {\r\n            this.insertText(data)\r\n          }\r\n\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Check if the editor is focused.\r\n     */\r\n\r\n    isFocused(): boolean {\r\n      return !!IS_FOCUSED.get(this)\r\n    }\r\n\r\n    /**\r\n     * Check if the editor is in read-only mode.\r\n     */\r\n\r\n    isReadOnly(): boolean {\r\n      return !!IS_READ_ONLY.get(this)\r\n    }\r\n\r\n    /**\r\n     * Blur the editor.\r\n     */\r\n\r\n    blur(): void {\r\n      const el = this.toDomNode(this.value)\r\n      IS_FOCUSED.set(this, false)\r\n\r\n      if (window.document.activeElement === el) {\r\n        el.blur()\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Focus the editor.\r\n     */\r\n\r\n    focus(): void {\r\n      const el = this.toDomNode(this.value)\r\n      IS_FOCUSED.set(this, true)\r\n\r\n      if (window.document.activeElement !== el) {\r\n        el.focus({ preventScroll: true })\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Deselect the editor.\r\n     */\r\n\r\n    deselect(): void {\r\n      const { selection } = this.value\r\n      const domSelection = window.getSelection()\r\n\r\n      if (domSelection && domSelection.rangeCount > 0) {\r\n        domSelection.removeAllRanges()\r\n      }\r\n\r\n      if (selection) {\r\n        this.apply({\r\n          type: 'set_selection',\r\n          properties: selection,\r\n          newProperties: null,\r\n        })\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Insert a `DataTransfer` object.\r\n     */\r\n\r\n    insertData(dataTransfer: DataTransfer): void {\r\n      const fragment = Utils.getFragmentData(dataTransfer)\r\n\r\n      if (fragment) {\r\n        this.insertFragment(fragment)\r\n        return\r\n      }\r\n\r\n      const text = dataTransfer.getData('text/plain')\r\n\r\n      if (text) {\r\n        const lines = text.split('\\n')\r\n        let split = false\r\n\r\n        for (const line of lines) {\r\n          if (split) {\r\n            this.splitNodes()\r\n          }\r\n\r\n          this.insertText(line)\r\n          split = true\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Transform an `InputEvent` into commands on the editor.\r\n     */\r\n\r\n    onBeforeInput(\r\n      event: Event & {\r\n        data: string | null\r\n        dataTransfer: DataTransfer | null\r\n        getTargetRanges(): DOMStaticRange[]\r\n        inputType: string\r\n        isComposing: boolean\r\n      }\r\n    ): void {\r\n      const { inputType, data, dataTransfer } = event\r\n\r\n      // Each of these input types reflects specific user intent, and most of them\r\n      // are cancellable so we can perform the action on the Slate model direclty.\r\n      // https://w3c.github.io/input-events/#dom-inputevent-inputtype\r\n      switch (inputType) {\r\n        case 'deleteByComposition':\r\n        case 'deleteByCut':\r\n        case 'deleteByDrag':\r\n        case 'deleteContent':\r\n        case 'deleteContentForward': {\r\n          this.delete()\r\n          break\r\n        }\r\n\r\n        case 'deleteContentBackward': {\r\n          this.delete({ reverse: true })\r\n          break\r\n        }\r\n\r\n        case 'deleteEntireSoftLine': {\r\n          this.delete({ unit: 'line', reverse: true })\r\n          this.delete({ unit: 'line' })\r\n          break\r\n        }\r\n\r\n        case 'deleteSoftLineBackward':\r\n        case 'deleteHardLineBackward': {\r\n          this.delete({ unit: 'line', reverse: true })\r\n          break\r\n        }\r\n\r\n        case 'deleteSoftLineForward':\r\n        case 'deleteHardLineForward': {\r\n          this.delete({ unit: 'line' })\r\n          break\r\n        }\r\n\r\n        case 'deleteWordBackward': {\r\n          this.delete({ unit: 'word', reverse: true })\r\n          break\r\n        }\r\n\r\n        case 'deleteWordForward': {\r\n          this.delete({ unit: 'word' })\r\n          break\r\n        }\r\n\r\n        case 'historyRedo': {\r\n          this.redo()\r\n          break\r\n        }\r\n\r\n        case 'historyUndo': {\r\n          this.undo()\r\n          break\r\n        }\r\n\r\n        case 'insertLineBreak':\r\n        case 'insertParagraph': {\r\n          this.splitNodes({ always: true })\r\n          break\r\n        }\r\n\r\n        case 'insertFromComposition':\r\n        case 'insertFromDrop':\r\n        case 'insertFromPaste':\r\n        case 'insertFromYank':\r\n        case 'insertReplacementText':\r\n        case 'insertText': {\r\n          if (dataTransfer != null) {\r\n            this.insertData(dataTransfer)\r\n          } else if (data != null) {\r\n            this.insertText(data)\r\n          }\r\n\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Transform a `KeyboardEvent` into commands on the editor. This should only\r\n     * be used for hotkeys which attach specific commands to specific key\r\n     * combinations. Most input logic will be handled by the `onBeforeInput`\r\n     * method instead.\r\n     */\r\n\r\n    onKeyDown(event: KeyboardEvent): void {\r\n      // COMPAT: Since we prevent the default behavior on `beforeinput` events,\r\n      // the browser doesn't think there's ever any history stack to undo or redo,\r\n      // so we have to manage these hotkeys ourselves. (2019/11/06)\r\n      if (Hotkeys.isRedo(event)) {\r\n        this.redo()\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isUndo(event)) {\r\n        this.undo()\r\n        return\r\n      }\r\n\r\n      // COMPAT: Certain browsers don't handle the selection updates\r\n      // properly. In Chrome, the selection isn't properly extended.\r\n      // And in Firefox, the selection isn't properly collapsed.\r\n      // (2017/10/17)\r\n      if (Hotkeys.isMoveLineBackward(event)) {\r\n        event.preventDefault()\r\n        this.move({ unit: 'line', reverse: true })\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isMoveLineForward(event)) {\r\n        event.preventDefault()\r\n        this.move({ unit: 'line' })\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isExtendLineBackward(event)) {\r\n        event.preventDefault()\r\n        this.move({ unit: 'line', edge: 'focus', reverse: true })\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isExtendLineForward(event)) {\r\n        event.preventDefault()\r\n        this.move({ unit: 'line', edge: 'focus' })\r\n        return\r\n      }\r\n\r\n      // COMPAT: If a void node is selected, or a zero-width text node\r\n      // adjacent to an inline is selected, we need to handle these\r\n      // hotkeys manually because browsers won't be able to skip over\r\n      // the void node with the zero-width space not being an empty\r\n      // string.\r\n      if (Hotkeys.isMoveBackward(event)) {\r\n        const { selection } = this.value\r\n        event.preventDefault()\r\n\r\n        if (selection && SlateRange.isCollapsed(selection)) {\r\n          this.move({ reverse: true })\r\n        } else {\r\n          this.collapse({ edge: 'start' })\r\n        }\r\n\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isMoveForward(event)) {\r\n        const { selection } = this.value\r\n        event.preventDefault()\r\n\r\n        if (selection && SlateRange.isCollapsed(selection)) {\r\n          this.move()\r\n        } else {\r\n          this.collapse({ edge: 'end' })\r\n        }\r\n\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isMoveWordBackward(event)) {\r\n        event.preventDefault()\r\n        this.move({ unit: 'word', reverse: true })\r\n        return\r\n      }\r\n\r\n      if (Hotkeys.isMoveWordForward(event)) {\r\n        event.preventDefault()\r\n        this.move({ unit: 'word' })\r\n        return\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Redo.\r\n     */\r\n\r\n    redo(): void {}\r\n\r\n    /**\r\n     * Undo.\r\n     */\r\n\r\n    undo(): void {}\r\n\r\n    /**\r\n     * Check if a DOM node is within the editor.\r\n     */\r\n\r\n    hasDomNode(target: DOMNode, options: { editable?: boolean } = {}): boolean {\r\n      const { editable = false } = options\r\n      const el = this.toDomNode(this.value)\r\n      let element\r\n\r\n      // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\r\n      // target is originating from an internal \"restricted\" element (e.g. a\r\n      // stepper arrow on a number input). (2018/05/04)\r\n      // https://github.com/ianstormtaylor/slate/issues/1819\r\n      try {\r\n        element = isDOMElement(target) ? target : target.parentElement\r\n      } catch (err) {\r\n        if (\r\n          !err.message.includes(\r\n            'Permission denied to access property \"nodeType\"'\r\n          )\r\n        ) {\r\n          throw err\r\n        }\r\n      }\r\n\r\n      if (!element) {\r\n        return false\r\n      }\r\n\r\n      return (\r\n        element.closest(`[data-slate-editor]`) === el &&\r\n        (!editable || el.isContentEditable)\r\n      )\r\n    }\r\n\r\n    /**\r\n     * Find the native DOM element from a Slate node.\r\n     */\r\n\r\n    toDomNode(node: SlateNode): HTMLElement {\r\n      const domNode = SlateValue.isValue(node)\r\n        ? EDITOR_TO_ELEMENT.get(this)\r\n        : KEY_TO_ELEMENT.get(this.findKey(node))\r\n\r\n      if (!domNode) {\r\n        throw new Error(\r\n          `Cannot resolve a DOM node from Slate node: ${JSON.stringify(node)}`\r\n        )\r\n      }\r\n\r\n      return domNode\r\n    }\r\n\r\n    /**\r\n     * Find a native DOM selection point from a Slate point.\r\n     */\r\n\r\n    toDomPoint(point: SlatePoint): DOMPoint {\r\n      const [node] = this.getNode(point.path)\r\n      const el = this.toDomNode(node)\r\n      let domPoint: DOMPoint | undefined\r\n\r\n      // For each leaf, we need to isolate its content, which means filtering\r\n      // to its direct text and zero-width spans. (We have to filter out any\r\n      // other siblings that may have been rendered alongside them.)\r\n      const selector = `[data-slate-string], [data-slate-zero-width]`\r\n      const texts = Array.from(el.querySelectorAll(selector))\r\n      let start = 0\r\n\r\n      for (const text of texts) {\r\n        const domNode = text.childNodes[0] as HTMLElement\r\n\r\n        if (domNode == null || domNode.textContent == null) {\r\n          continue\r\n        }\r\n\r\n        const { length } = domNode.textContent\r\n        const attr = text.getAttribute('data-slate-length')\r\n        const trueLength = attr == null ? length : parseInt(attr, 10)\r\n        const end = start + trueLength\r\n\r\n        if (point.offset <= end) {\r\n          const offset = Math.min(length, Math.max(0, point.offset - start))\r\n          domPoint = [domNode, offset]\r\n          break\r\n        }\r\n\r\n        start = end\r\n      }\r\n\r\n      if (!domPoint) {\r\n        throw new Error(\r\n          `Cannot resolve a DOM point from Slate point: ${JSON.stringify(\r\n            point\r\n          )}`\r\n        )\r\n      }\r\n\r\n      return domPoint\r\n    }\r\n\r\n    /**\r\n     * Find a native DOM range from a Slate `range`.\r\n     */\r\n\r\n    toDomRange(range: SlateRange): DOMRange {\r\n      const { anchor, focus } = range\r\n      const domAnchor = this.toDomPoint(anchor)\r\n      const domFocus = SlateRange.isCollapsed(range)\r\n        ? domAnchor\r\n        : this.toDomPoint(focus)\r\n\r\n      const domRange = window.document.createRange()\r\n      const start = SlateRange.isBackward(range) ? domFocus : domAnchor\r\n      const end = SlateRange.isBackward(range) ? domAnchor : domFocus\r\n      domRange.setStart(start[0], start[1])\r\n      domRange.setEnd(end[0], end[1])\r\n      return domRange\r\n    }\r\n\r\n    /**\r\n     * Find a Slate node from a native DOM `element`.\r\n     */\r\n\r\n    toSlateNode(domNode: DOMNode): SlateNode {\r\n      let domEl = isDOMElement(domNode) ? domNode : domNode.parentElement\r\n\r\n      if (domEl && !domEl.hasAttribute('data-slate-node')) {\r\n        domEl = domEl.closest(`[data-slate-node]`)\r\n      }\r\n\r\n      const node = domEl ? ELEMENT_TO_NODE.get(domEl as HTMLElement) : null\r\n\r\n      if (!node) {\r\n        throw new Error(`Cannot resolve a Slate node from DOM node: ${domEl}`)\r\n      }\r\n\r\n      return node\r\n    }\r\n\r\n    /**\r\n     * Get the target range from a DOM `event`.\r\n     */\r\n\r\n    findEventRange(event: any): SlateRange | undefined {\r\n      if ('nativeEvent' in event) {\r\n        event = event.nativeEvent\r\n      }\r\n\r\n      const { clientX: x, clientY: y, target } = event\r\n\r\n      if (x == null || y == null) {\r\n        return\r\n      }\r\n\r\n      const node = this.toSlateNode(event.target)\r\n      const path = this.findPath(node)\r\n\r\n      // If the drop target is inside a void node, move it into either the\r\n      // next or previous node, depending on which side the `x` and `y`\r\n      // coordinates are closest to.\r\n      if (SlateElement.isElement(node) && this.isVoid(node)) {\r\n        const rect = target.getBoundingClientRect()\r\n        const isPrev = this.isInline(node)\r\n          ? x - rect.left < rect.left + rect.width - x\r\n          : y - rect.top < rect.top + rect.height - y\r\n\r\n        const edge = this.getPoint(path, { edge: isPrev ? 'start' : 'end' })\r\n        const point = isPrev ? this.getBefore(edge) : this.getAfter(edge)\r\n\r\n        if (point) {\r\n          const range = this.getRange(point)\r\n          return range\r\n        }\r\n      }\r\n\r\n      // Else resolve a range from the caret position where the drop occured.\r\n      let domRange\r\n      const { document } = window\r\n\r\n      // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\r\n      if (document.caretRangeFromPoint) {\r\n        domRange = document.caretRangeFromPoint(x, y)\r\n      } else {\r\n        const position = document.caretPositionFromPoint(x, y)\r\n\r\n        if (position) {\r\n          domRange = document.createRange()\r\n          domRange.setStart(position.offsetNode, position.offset)\r\n          domRange.setEnd(position.offsetNode, position.offset)\r\n        }\r\n      }\r\n\r\n      if (!domRange) {\r\n        throw new Error(\r\n          `Cannot resolve a Slate range from a DOM event: ${event}`\r\n        )\r\n      }\r\n\r\n      // Resolve a Slate range from the DOM range.\r\n      const range = this.toSlateRange(domRange)\r\n      return range\r\n    }\r\n\r\n    /**\r\n     * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\r\n     */\r\n\r\n    toSlatePoint(domPoint: DOMPoint): SlatePoint {\r\n      const [nearestNode, nearestOffset] = normalizeDOMPoint(domPoint)\r\n      const parentNode = nearestNode.parentNode as DOMElement\r\n      let textNode: DOMElement | null = null\r\n      let offset = 0\r\n\r\n      if (parentNode) {\r\n        const voidNode = parentNode.closest('[data-slate-void=\"true\"]')\r\n        let leafNode = parentNode.closest('[data-slate-leaf]')\r\n        let domNode: DOMElement | null = null\r\n\r\n        // Calculate how far into the text node the `nearestNode` is, so that we\r\n        // can determine what the offset relative to the text node is.\r\n        if (leafNode) {\r\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\r\n          const range = window.document.createRange()\r\n          range.setStart(textNode, 0)\r\n          range.setEnd(nearestNode, nearestOffset)\r\n          const contents = range.cloneContents()\r\n          const zeroWidths = contents.querySelectorAll(\r\n            '[data-slate-zero-width]'\r\n          )\r\n\r\n          Array.from(zeroWidths).forEach(el => {\r\n            el!.parentNode!.removeChild(el)\r\n          })\r\n\r\n          // COMPAT: Edge has a bug where SlateRange.prototype.toString() will\r\n          // convert \\n into \\r\\n. The bug causes a loop when slate-react\r\n          // attempts to reposition its cursor to match the native position. Use\r\n          // textContent.length instead.\r\n          // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\r\n          offset = contents.textContent!.length\r\n          domNode = textNode\r\n        } else if (voidNode) {\r\n          // For void nodes, the element with the offset key will be a cousin, not an\r\n          // ancestor, so find it by going down from the nearest void parent.\r\n\r\n          leafNode = voidNode.querySelector('[data-slate-leaf]')!\r\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\r\n          domNode = leafNode\r\n          offset = domNode.textContent!.length\r\n        }\r\n\r\n        // COMPAT: If the parent node is a Slate zero-width space, this is\r\n        // because the text node should have no characters. However, during IME\r\n        // composition the ASCII characters will be prepended to the zero-width\r\n        // space, so subtract 1 from the offset to account for the zero-width\r\n        // space character.\r\n        if (\r\n          domNode &&\r\n          offset === domNode.textContent!.length &&\r\n          parentNode.hasAttribute('data-slate-zero-width')\r\n        ) {\r\n          offset--\r\n        }\r\n      }\r\n\r\n      if (!textNode) {\r\n        throw new Error(\r\n          `Cannot resolve a Slate point from DOM point: ${domPoint}`\r\n        )\r\n      }\r\n\r\n      // COMPAT: If someone is clicking from one Slate editor into another,\r\n      // the select event fires twice, once for the old editor's `element`\r\n      // first, and then afterwards for the correct `element`. (2017/03/03)\r\n      const slateNode = this.toSlateNode(textNode!)\r\n      const path = this.findPath(slateNode)\r\n      return { path, offset }\r\n    }\r\n\r\n    /**\r\n     * Find a Slate range from a DOM range or selection.\r\n     */\r\n\r\n    toSlateRange(\r\n      domRange: DOMRange | DOMStaticRange | DOMSelection\r\n    ): SlateRange {\r\n      const el =\r\n        domRange instanceof Selection\r\n          ? domRange.anchorNode\r\n          : domRange.startContainer\r\n      let anchorNode\r\n      let anchorOffset\r\n      let focusNode\r\n      let focusOffset\r\n      let isCollapsed\r\n\r\n      if (el) {\r\n        if (domRange instanceof Selection) {\r\n          anchorNode = domRange.anchorNode\r\n          anchorOffset = domRange.anchorOffset\r\n          focusNode = domRange.focusNode\r\n          focusOffset = domRange.focusOffset\r\n          isCollapsed = domRange.isCollapsed\r\n        } else {\r\n          anchorNode = domRange.startContainer\r\n          anchorOffset = domRange.startOffset\r\n          focusNode = domRange.endContainer\r\n          focusOffset = domRange.endOffset\r\n          isCollapsed = domRange.collapsed\r\n        }\r\n      }\r\n\r\n      if (\r\n        anchorNode == null ||\r\n        focusNode == null ||\r\n        anchorOffset == null ||\r\n        focusOffset == null\r\n      ) {\r\n        throw new Error(\r\n          `Cannot resolve a Slate range from DOM range: ${domRange}`\r\n        )\r\n      }\r\n\r\n      const anchor = this.toSlatePoint([anchorNode, anchorOffset])\r\n      const focus = isCollapsed\r\n        ? anchor\r\n        : this.toSlatePoint([focusNode, focusOffset])\r\n\r\n      return { anchor, focus }\r\n    }\r\n  }\r\n}\r\n"],"names":["EditorContext","createContext","undefined","useEditor","editor","useContext","Error","Node","NODE_TO_INDEX","WeakMap","NODE_TO_PARENT","EDITOR_TO_ELEMENT","NODE_TO_ELEMENT","ELEMENT_TO_NODE","NODE_TO_KEY","KEY_TO_ELEMENT","IS_READ_ONLY","IS_FOCUSED","PLACEHOLDER","PLACEHOLDER_SYMBOL","Symbol","Leaf","leaf","another","text","annotations","length","decorations","marks","every","m","Mark","exists","isRangeListEqual","isRangeMapEqual","value","isPlainObject","isMarkSet","Range","isRangeList","isRangeMap","offset","slice","list","i","range","other","equals","map","Object","keys","key","SlateLeaf","ReadOnlyContext","useReadOnly","SelectedContext","useSelected","Text","Element","ElementComponent","TextComponent","FocusedContext","useFocused","IS_IOS","navigator","window","test","userAgent","MSStream","IS_APPLE","IS_FIREFOX","IS_SAFARI","isDOMComment","isDOMNode","nodeType","isDOMElement","isDOMText","normalizeDOMPoint","domPoint","node","childNodes","isLast","direction","index","getEditableChild","textContent","parent","child","triedForward","triedBackward","getAttribute","Utils","dataTransfer","base64","getData","decoded","decodeURIComponent","atob","fragment","JSON","parse","selection","SlateRange","edges","start","end","startVoid","getMatch","path","endVoid","isCollapsed","domRange","toDomRange","contents","cloneContents","attach","forEach","trim","voidNode","r","cloneRange","domNode","toDomNode","setEndAfter","querySelector","Array","from","querySelectorAll","zw","isNewline","span","document","createElement","style","whiteSpace","appendChild","SlateNode","string","stringify","encoded","btoa","encodeURIComponent","setAttribute","setData","div","innerHTML","getPlainText","nodeValue","childNode","display","getComputedStyle","getPropertyValue","tagName","useSlate","Editor","useMemo","_typeof","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","deleteBackward","deleteForward","extendBackward","extendForward","italic","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","create","generic","apple","windows","isGeneric","isKeyHotkey","isApple","isWindows","event","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSplitBlock","isTransposeCharacter","isUndo","n","Key","id","withReact","op","matches","type","levels","at","findKey","push","Path","getNode","set","get","SlateValue","isValue","unshift","placeholder","children","texts","getStart","data","reverse","unit","select","splitNodes","always","DataTransfer","insertData","insertText","el","activeElement","blur","focus","preventScroll","domSelection","getSelection","rangeCount","removeAllRanges","apply","properties","newProperties","getFragmentData","insertFragment","lines","split","line","inputType","Hotkeys","preventDefault","move","edge","collapse","target","options","editable","element","parentElement","err","message","includes","closest","isContentEditable","point","selector","attr","trueLength","parseInt","Math","min","max","anchor","domAnchor","toDomPoint","domFocus","createRange","isBackward","setStart","setEnd","domEl","hasAttribute","nativeEvent","x","clientX","y","clientY","toSlateNode","findPath","SlateElement","isElement","isVoid","rect","getBoundingClientRect","isPrev","isInline","left","width","top","height","getPoint","getBefore","getAfter","getRange","caretRangeFromPoint","position","caretPositionFromPoint","offsetNode","toSlateRange","nearestNode","nearestOffset","parentNode","textNode","leafNode","zeroWidths","removeChild","slateNode","Selection","anchorNode","startContainer","anchorOffset","focusNode","focusOffset","startOffset","endContainer","endOffset","collapsed","toSlatePoint"],"mappings":"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"}